<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Data Visualisation | Using R at Grattan Institute</title>
  <meta name="description" content="How to use R at Grattan good. In development." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Data Visualisation | Using R at Grattan Institute" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="How to use R at Grattan good. In development." />
  <meta name="github-repo" content="grattan/R_at_Grattan" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Data Visualisation | Using R at Grattan Institute" />
  
  <meta name="twitter:description" content="How to use R at Grattan good. In development." />
  

<meta name="author" content="Will Mackey and Matt Cowgill" />


<meta name="date" content="2019-10-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-tidyverse.html">
<link rel="next" href="chart-cookbook.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Using R at Grattan Institute</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#what-is-r"><i class="fa fa-check"></i><b>1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#what-is-rstudio"><i class="fa fa-check"></i><b>1.2</b> What is RStudio?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>1.3</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#packages"><i class="fa fa-check"></i><b>1.4</b> Packages</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#installing-packages"><i class="fa fa-check"></i><b>1.4.1</b> Installing packages</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#using-packages"><i class="fa fa-check"></i><b>1.4.2</b> Using packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="why-use-r.html"><a href="why-use-r.html"><i class="fa fa-check"></i><b>2</b> Why use R?</a><ul>
<li class="chapter" data-level="2.1" data-path="why-use-r.html"><a href="why-use-r.html#why-script"><i class="fa fa-check"></i><b>2.1</b> Why use script-based software?</a></li>
<li class="chapter" data-level="2.2" data-path="why-use-r.html"><a href="why-use-r.html#why-R"><i class="fa fa-check"></i><b>2.2</b> Why use R specifically?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="organising-projects.html"><a href="organising-projects.html"><i class="fa fa-check"></i><b>3</b> Organising an R project at Grattan</a><ul>
<li class="chapter" data-level="3.1" data-path="organising-projects.html"><a href="organising-projects.html#use-rstudio-projects-not-setwd"><i class="fa fa-check"></i><b>3.1</b> Use RStudio projects, not <code>setwd()</code></a></li>
<li class="chapter" data-level="3.2" data-path="organising-projects.html"><a href="organising-projects.html#keep-your-stuff-together"><i class="fa fa-check"></i><b>3.2</b> Keep your stuff together</a></li>
<li class="chapter" data-level="3.3" data-path="organising-projects.html"><a href="organising-projects.html#README"><i class="fa fa-check"></i><b>3.3</b> Include a README file</a></li>
<li class="chapter" data-level="3.4" data-path="organising-projects.html"><a href="organising-projects.html#use-relative-filepaths"><i class="fa fa-check"></i><b>3.4</b> Use relative filepaths</a></li>
<li class="chapter" data-level="3.5" data-path="organising-projects.html"><a href="organising-projects.html#manageable"><i class="fa fa-check"></i><b>3.5</b> Keep your scripts manageable</a></li>
<li class="chapter" data-level="3.6" data-path="organising-projects.html"><a href="organising-projects.html#omit-needless-code"><i class="fa fa-check"></i><b>3.6</b> Omit needless code</a></li>
<li class="chapter" data-level="3.7" data-path="organising-projects.html"><a href="organising-projects.html#rules_9a_final_final_mc"><i class="fa fa-check"></i><b>3.7</b> Rules_9a_FINAL_FINAL_MC</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="grattan-coding-style.html"><a href="grattan-coding-style.html"><i class="fa fa-check"></i><b>4</b> Grattan coding style</a><ul>
<li class="chapter" data-level="4.1" data-path="grattan-coding-style.html"><a href="grattan-coding-style.html#script-preamble"><i class="fa fa-check"></i><b>4.1</b> Script preamble</a></li>
<li class="chapter" data-level="4.2" data-path="grattan-coding-style.html"><a href="grattan-coding-style.html#use-comments"><i class="fa fa-check"></i><b>4.2</b> Use comments</a></li>
<li class="chapter" data-level="4.3" data-path="grattan-coding-style.html"><a href="grattan-coding-style.html#breaking-your-script-into-chunks"><i class="fa fa-check"></i><b>4.3</b> Breaking your script into chunks</a></li>
<li class="chapter" data-level="4.4" data-path="grattan-coding-style.html"><a href="grattan-coding-style.html#naming-objects-and-variables"><i class="fa fa-check"></i><b>4.4</b> Naming objects and variables</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spacing.html"><a href="spacing.html"><i class="fa fa-check"></i><b>5</b> Spacing</a><ul>
<li class="chapter" data-level="5.1" data-path="spacing.html"><a href="spacing.html#assign-and-equals"><i class="fa fa-check"></i><b>5.1</b> Assign and equals</a></li>
<li class="chapter" data-level="5.2" data-path="spacing.html"><a href="spacing.html#commas"><i class="fa fa-check"></i><b>5.2</b> Commas</a></li>
<li class="chapter" data-level="5.3" data-path="spacing.html"><a href="spacing.html#parentheses"><i class="fa fa-check"></i><b>5.3</b> Parentheses</a></li>
<li class="chapter" data-level="5.4" data-path="spacing.html"><a href="spacing.html#short-lines-and-line-indentation"><i class="fa fa-check"></i><b>5.4</b> Short lines and line indentation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="blocks-of-code.html"><a href="blocks-of-code.html"><i class="fa fa-check"></i><b>6</b> Blocks of code</a></li>
<li class="chapter" data-level="7" data-path="the-tidyverse.html"><a href="the-tidyverse.html"><i class="fa fa-check"></i><b>7</b> The tidyverse</a><ul>
<li class="chapter" data-level="7.1" data-path="the-tidyverse.html"><a href="the-tidyverse.html#what-is-the-tidyverse-and-why-do-we-use-it"><i class="fa fa-check"></i><b>7.1</b> What is the tidyverse and why do we use it?</a></li>
<li class="chapter" data-level="7.2" data-path="the-tidyverse.html"><a href="the-tidyverse.html#an-introduction-to-rmarkdown"><i class="fa fa-check"></i><b>7.2</b> An introduction to RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-visualisation.html"><a href="data-visualisation.html"><i class="fa fa-check"></i><b>8</b> Data Visualisation</a><ul>
<li class="chapter" data-level="8.1" data-path="data-visualisation.html"><a href="data-visualisation.html#introduction-to-data-visualisation"><i class="fa fa-check"></i><b>8.1</b> Introduction to data visualisation</a></li>
<li class="chapter" data-level="8.2" data-path="data-visualisation.html"><a href="data-visualisation.html#set-up-and-packages"><i class="fa fa-check"></i><b>8.2</b> Set-up and packages</a></li>
<li class="chapter" data-level="8.3" data-path="data-visualisation.html"><a href="data-visualisation.html#concepts"><i class="fa fa-check"></i><b>8.3</b> Concepts</a></li>
<li class="chapter" data-level="8.4" data-path="data-visualisation.html"><a href="data-visualisation.html#exploratory-data-visualisation"><i class="fa fa-check"></i><b>8.4</b> Exploratory data visualisation</a></li>
<li class="chapter" data-level="8.5" data-path="data-visualisation.html"><a href="data-visualisation.html#making-grattan-y-charts"><i class="fa fa-check"></i><b>8.5</b> Making Grattan-y charts</a><ul>
<li class="chapter" data-level="8.5.1" data-path="data-visualisation.html"><a href="data-visualisation.html#making-grattan-charts"><i class="fa fa-check"></i><b>8.5.1</b> Making Grattan charts</a></li>
<li class="chapter" data-level="8.5.2" data-path="data-visualisation.html"><a href="data-visualisation.html#saving-grattan-charts"><i class="fa fa-check"></i><b>8.5.2</b> Saving Grattan charts</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="data-visualisation.html"><a href="data-visualisation.html#adding-labels"><i class="fa fa-check"></i><b>8.6</b> Adding labels</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chart-cookbook.html"><a href="chart-cookbook.html"><i class="fa fa-check"></i><b>9</b> Chart cookbook</a><ul>
<li class="chapter" data-level="9.1" data-path="chart-cookbook.html"><a href="chart-cookbook.html#set-up"><i class="fa fa-check"></i><b>9.1</b> Set up</a></li>
<li class="chapter" data-level="9.2" data-path="chart-cookbook.html"><a href="chart-cookbook.html#bar-charts"><i class="fa fa-check"></i><b>9.2</b> Bar charts</a><ul>
<li class="chapter" data-level="9.2.1" data-path="chart-cookbook.html"><a href="chart-cookbook.html#simple-bar-plot"><i class="fa fa-check"></i><b>9.2.1</b> Simple bar plot</a></li>
<li class="chapter" data-level="9.2.2" data-path="chart-cookbook.html"><a href="chart-cookbook.html#bar-multi"><i class="fa fa-check"></i><b>9.2.2</b> Bar plot with multiple series</a></li>
<li class="chapter" data-level="9.2.3" data-path="chart-cookbook.html"><a href="chart-cookbook.html#facet-bar"><i class="fa fa-check"></i><b>9.2.3</b> Facetted bar charts</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chart-cookbook.html"><a href="chart-cookbook.html#line-charts"><i class="fa fa-check"></i><b>9.3</b> Line charts</a><ul>
<li class="chapter" data-level="9.3.1" data-path="chart-cookbook.html"><a href="chart-cookbook.html#simple-line-chart"><i class="fa fa-check"></i><b>9.3.1</b> Simple line chart</a></li>
<li class="chapter" data-level="9.3.2" data-path="chart-cookbook.html"><a href="chart-cookbook.html#line-chart-with-multiple-series"><i class="fa fa-check"></i><b>9.3.2</b> Line chart with multiple series</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="chart-cookbook.html"><a href="chart-cookbook.html#scatter-plots"><i class="fa fa-check"></i><b>9.4</b> Scatter plots</a><ul>
<li class="chapter" data-level="9.4.1" data-path="chart-cookbook.html"><a href="chart-cookbook.html#simple-scatter-plot"><i class="fa fa-check"></i><b>9.4.1</b> Simple scatter plot</a></li>
<li class="chapter" data-level="9.4.2" data-path="chart-cookbook.html"><a href="chart-cookbook.html#scatter-plot-with-reshaped-data"><i class="fa fa-check"></i><b>9.4.2</b> Scatter plot with reshaped data</a></li>
<li class="chapter" data-level="9.4.3" data-path="chart-cookbook.html"><a href="chart-cookbook.html#layered-scatter-plot"><i class="fa fa-check"></i><b>9.4.3</b> Layered scatter plot</a></li>
<li class="chapter" data-level="9.4.4" data-path="chart-cookbook.html"><a href="chart-cookbook.html#scatter-plots-with-trendlines"><i class="fa fa-check"></i><b>9.4.4</b> Scatter plots with trendlines</a></li>
<li class="chapter" data-level="9.4.5" data-path="chart-cookbook.html"><a href="chart-cookbook.html#facetted-scatter-plots"><i class="fa fa-check"></i><b>9.4.5</b> Facetted scatter plots</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="chart-cookbook.html"><a href="chart-cookbook.html#distributions"><i class="fa fa-check"></i><b>9.5</b> Distributions</a></li>
<li class="chapter" data-level="9.6" data-path="chart-cookbook.html"><a href="chart-cookbook.html#maps"><i class="fa fa-check"></i><b>9.6</b> Maps</a><ul>
<li class="chapter" data-level="9.6.1" data-path="chart-cookbook.html"><a href="chart-cookbook.html#sf-objects"><i class="fa fa-check"></i><b>9.6.1</b> <code>sf</code> objects</a></li>
<li class="chapter" data-level="9.6.2" data-path="chart-cookbook.html"><a href="chart-cookbook.html#using-absmapsdata"><i class="fa fa-check"></i><b>9.6.2</b> Using <code>absmapsdata</code></a></li>
<li class="chapter" data-level="9.6.3" data-path="chart-cookbook.html"><a href="chart-cookbook.html#making-choropleth-maps"><i class="fa fa-check"></i><b>9.6.3</b> Making choropleth maps</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="chart-cookbook.html"><a href="chart-cookbook.html#creating-simple-interactive-graphs-with-plotly"><i class="fa fa-check"></i><b>9.7</b> Creating simple interactive graphs with <code>plotly</code></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="reading-data.html"><a href="reading-data.html"><i class="fa fa-check"></i><b>10</b> Reading data</a><ul>
<li class="chapter" data-level="10.1" data-path="reading-data.html"><a href="reading-data.html#importing-data"><i class="fa fa-check"></i><b>10.1</b> Importing data</a><ul>
<li class="chapter" data-level="10.1.1" data-path="reading-data.html"><a href="reading-data.html#reading-csv-files"><i class="fa fa-check"></i><b>10.1.1</b> Reading CSV files</a></li>
<li class="chapter" data-level="10.1.2" data-path="reading-data.html"><a href="reading-data.html#readxlread_excel"><i class="fa fa-check"></i><b>10.1.2</b> <code>readxl::read_excel()</code></a></li>
<li class="chapter" data-level="10.1.3" data-path="reading-data.html"><a href="reading-data.html#rio"><i class="fa fa-check"></i><b>10.1.3</b> <code>rio</code></a></li>
<li class="chapter" data-level="10.1.4" data-path="reading-data.html"><a href="reading-data.html#readabs"><i class="fa fa-check"></i><b>10.1.4</b> <code>readabs</code></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="reading-data.html"><a href="reading-data.html#reading-common-files"><i class="fa fa-check"></i><b>10.2</b> Reading common files:</a></li>
<li class="chapter" data-level="10.3" data-path="reading-data.html"><a href="reading-data.html#appropriately-renaming-variables"><i class="fa fa-check"></i><b>10.3</b> Appropriately renaming variables</a></li>
<li class="chapter" data-level="10.4" data-path="reading-data.html"><a href="reading-data.html#getting-to-tidy-data"><i class="fa fa-check"></i><b>10.4</b> Getting to tidy data</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="different-data-types.html"><a href="different-data-types.html"><i class="fa fa-check"></i><b>11</b> Different data types</a><ul>
<li class="chapter" data-level="11.1" data-path="different-data-types.html"><a href="different-data-types.html#tidy-data"><i class="fa fa-check"></i><b>11.1</b> Tidy data</a></li>
<li class="chapter" data-level="11.2" data-path="different-data-types.html"><a href="different-data-types.html#dates-with-lubridate"><i class="fa fa-check"></i><b>11.2</b> Dates with <code>lubridate::</code></a></li>
<li class="chapter" data-level="11.3" data-path="different-data-types.html"><a href="different-data-types.html#strings-with-stringr"><i class="fa fa-check"></i><b>11.3</b> Strings with <code>stringr::</code></a></li>
<li class="chapter" data-level="11.4" data-path="different-data-types.html"><a href="different-data-types.html#factors-with-forcats"><i class="fa fa-check"></i><b>11.4</b> Factors with <code>forcats::</code></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>12</b> Data transformation</a><ul>
<li class="chapter" data-level="12.1" data-path="data-transformation.html"><a href="data-transformation.html#the-pipe"><i class="fa fa-check"></i><b>12.1</b> The pipe</a></li>
<li class="chapter" data-level="12.2" data-path="data-transformation.html"><a href="data-transformation.html#key-dplyr-functions"><i class="fa fa-check"></i><b>12.2</b> Key <code>dplyr</code> functions:</a></li>
<li class="chapter" data-level="12.3" data-path="data-transformation.html"><a href="data-transformation.html#filter-with-filter"><i class="fa fa-check"></i><b>12.3</b> Filter with <code>filter()</code></a></li>
<li class="chapter" data-level="12.4" data-path="data-transformation.html"><a href="data-transformation.html#arrange-with-arrange"><i class="fa fa-check"></i><b>12.4</b> Arrange with <code>arrange()</code></a></li>
<li class="chapter" data-level="12.5" data-path="data-transformation.html"><a href="data-transformation.html#select-variables-with-select"><i class="fa fa-check"></i><b>12.5</b> Select variables with <code>select()</code></a></li>
<li class="chapter" data-level="12.6" data-path="data-transformation.html"><a href="data-transformation.html#group-data-with-group_by"><i class="fa fa-check"></i><b>12.6</b> Group data with <code>group_by()</code></a></li>
<li class="chapter" data-level="12.7" data-path="data-transformation.html"><a href="data-transformation.html#edit-and-add-new-variables-with-mutate"><i class="fa fa-check"></i><b>12.7</b> Edit and add new variables with <code>mutate()</code></a><ul>
<li class="chapter" data-level="12.7.1" data-path="data-transformation.html"><a href="data-transformation.html#cases-when-you-should-use-case_when"><i class="fa fa-check"></i><b>12.7.1</b> Cases when you should use <code>case_when()</code></a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="data-transformation.html"><a href="data-transformation.html#summarise-data-with-summarise"><i class="fa fa-check"></i><b>12.8</b> Summarise data with <code>summarise()</code></a></li>
<li class="chapter" data-level="12.9" data-path="data-transformation.html"><a href="data-transformation.html#joining-datasets-with-_join"><i class="fa fa-check"></i><b>12.9</b> Joining datasets with <code>*_join()</code></a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="analysis.html"><a href="analysis.html"><i class="fa fa-check"></i><b>13</b> Analysis</a></li>
<li class="chapter" data-level="14" data-path="creating-functions.html"><a href="creating-functions.html"><i class="fa fa-check"></i><b>14</b> Creating functions</a><ul>
<li class="chapter" data-level="14.1" data-path="creating-functions.html"><a href="creating-functions.html#it-can-be-useful-to-make-your-own-function"><i class="fa fa-check"></i><b>14.1</b> It can be useful to make your own function</a></li>
<li class="chapter" data-level="14.2" data-path="creating-functions.html"><a href="creating-functions.html#defining-simple-functions"><i class="fa fa-check"></i><b>14.2</b> Defining simple functions</a></li>
<li class="chapter" data-level="14.3" data-path="creating-functions.html"><a href="creating-functions.html#more-complex-functions"><i class="fa fa-check"></i><b>14.3</b> More complex functions</a></li>
<li class="chapter" data-level="14.4" data-path="creating-functions.html"><a href="creating-functions.html#sets-of-functions"><i class="fa fa-check"></i><b>14.4</b> Sets of functions</a></li>
<li class="chapter" data-level="14.5" data-path="creating-functions.html"><a href="creating-functions.html#using-purrrmap"><i class="fa fa-check"></i><b>14.5</b> Using <code>purrr::map</code></a></li>
<li class="chapter" data-level="14.6" data-path="creating-functions.html"><a href="creating-functions.html#sharing-your-useful-functions-with-grattan"><i class="fa fa-check"></i><b>14.6</b> Sharing your useful functions with Grattan</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="version-control.html"><a href="version-control.html"><i class="fa fa-check"></i><b>15</b> Version control</a><ul>
<li class="chapter" data-level="15.1" data-path="version-control.html"><a href="version-control.html#version-control-is-important-and-intimidating"><i class="fa fa-check"></i><b>15.1</b> Version control is important and intimidating</a></li>
<li class="chapter" data-level="15.2" data-path="version-control.html"><a href="version-control.html#github"><i class="fa fa-check"></i><b>15.2</b> Github</a></li>
<li class="chapter" data-level="15.3" data-path="version-control.html"><a href="version-control.html#git"><i class="fa fa-check"></i><b>15.3</b> Git</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using R at Grattan Institute</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-visualisation" class="section level1">
<h1><span class="header-section-number">8</span> Data Visualisation</h1>
<p>This chapter explores data visualisation broadly, and how to ‘do’ data visualisation in R specifically.</p>
<p>The next chapter – the Visualisation Cookbook – gives more practical advice for the charts you might want to create.</p>
<div id="introduction-to-data-visualisation" class="section level2">
<h2><span class="header-section-number">8.1</span> Introduction to data visualisation</h2>
<p>You can use data visualisation to <strong>examine and explore</strong> your data, and to <strong>present</strong> a finding to your audience. Both of these elements are important.</p>
<p>When you start using a dataset, you should look at it.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> Plot histograms of variables-of-interest to spot outliers. Explore correlations between variables with scatter plots and lines-of-best-fit. Check how many observations are in particular groups with bar charts. Identify variables that have missing or coded-missing values. Use faceting to explore differences in the above between groups, and do it interactively with non-static plots.</p>
<p>These <strong>exploratory plots</strong> are just for you and your team. They don’t need to be perfectly labelled, the right size, in the Grattan palette, or be particularly interesting.
They’re built and used only to help you and your team explore the data.
Through this process, you can become confident your data is <em>what you think it is</em>.</p>
<p>When you choose to <strong>present a visualisation to a reader</strong>, you have to make decisions about what they can and cannot see. You need to highlight or omit particular things to help them better understand the message you are presenting.</p>
<p>This requires important <em>technical</em> decisions: what data to use, what ‘stat’ to present it with — <em>show every data point, show a distribution function, show the average or the median?</em> — and on what scale — <em>raw numbers, on a log scale, as a proportion of a total?</em>.</p>
<p>It also requires <em>aesthetic</em> decisions. What colours in the Grattan palette would work best? Where should the labels be placed and how could they be phrased to succinctly convey meaning? Should data points be represented by lines, or bars, or dots, or balloons, or shades of colour?</p>
<p>All of these decisions need to made with two things in mind:</p>
<ol style="list-style-type: decimal">
<li>Rigour, accuracy, legitimacy: the chart needs to be honest.</li>
<li>The reader: the chart needs to help the reader understand something, and it must convince them to pay attention.</li>
</ol>
<p>At the margins, sometimes these two ideas can be in conflict. Maybe a 70-word definition in the middle of your chart would improve its technical accuracy, but it could confuse the average reader and reduce the chart’s impact.</p>
<p>Similarly, a bar chart is often the safest way to display data. Like our prose, our charts need to be designed for an interested teenager. But we need to <em>earn</em> their interest. If your reader has seen four similar bar charts in a row and has stopped paying attention by the fifth, your point loses its punch.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></p>
<p>The way we design charts – much like our writing – should always be honest, clear and engaging to the reader.</p>
<p>This chapter shows how you can do this with R. It starts with the ‘grammar of graphics’ concepts of a package called <code>ggplot</code>, and explains how to make those charts ‘Grattan-y’. The next chapter gives you the when-to-use and how-to-make particular charts.</p>
</div>
<div id="set-up-and-packages" class="section level2">
<h2><span class="header-section-number">8.2</span> Set-up and packages</h2>
<p>This section uses the package <code>ggplot2</code> to visualise data, and <code>dplyr</code> functions to manipulate data. Both of these packages are loaded with <code>tidyverse</code>. The <code>scales</code> package helps with labelling your axes.</p>
<p>The <code>grattantheme</code> package is used to make charts look Grattan-y. The <code>absmapsdata</code> package is used to help make maps.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="kw">library</span>(grattantheme)</a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="kw">library</span>(ggrepel)</a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="kw">library</span>(scales)</a></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="co"># note: to be added to grattantheme; remove this when done</span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2">grattan_label &lt;-<span class="st"> </span><span class="cf">function</span>(..., <span class="dt">size =</span> <span class="dv">18</span>) {</a>
<a class="sourceLine" id="cb31-3" data-line-number="3"></a>
<a class="sourceLine" id="cb31-4" data-line-number="4">  .size =<span class="st"> </span>size <span class="op">/</span><span class="st"> </span>ggplot2<span class="op">::</span>.pt</a>
<a class="sourceLine" id="cb31-5" data-line-number="5">  </a>
<a class="sourceLine" id="cb31-6" data-line-number="6"><span class="kw">geom_label</span>(..., </a>
<a class="sourceLine" id="cb31-7" data-line-number="7">           <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>,</a>
<a class="sourceLine" id="cb31-8" data-line-number="8">           <span class="dt">label.padding =</span> <span class="kw">unit</span>(<span class="fl">0.01</span>, <span class="st">&quot;lines&quot;</span>), </a>
<a class="sourceLine" id="cb31-9" data-line-number="9">           <span class="dt">label.size =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb31-10" data-line-number="10">           <span class="dt">size =</span> .size)</a>
<a class="sourceLine" id="cb31-11" data-line-number="11">}</a></code></pre></div>
<p>For most charts in this chapter, we’ll use the <code>sa3_income</code> data summarised below.<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a> It is a long dataset containing the median income and number of workers by SA3, occupation and gender between 2010 and 2015. We will also create a <code>professionals</code> subset that only includes people in professional occupations in 2015:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">sa3_income &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/sa3_income.csv&quot;</span>)</a>
<a class="sourceLine" id="cb32-2" data-line-number="2"></a>
<a class="sourceLine" id="cb32-3" data-line-number="3">professionals &lt;-<span class="st"> </span>sa3_income <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>sa4_name, <span class="op">-</span>gcc_name) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-5" data-line-number="5"><span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2015</span>,</a>
<a class="sourceLine" id="cb32-6" data-line-number="6">         occupation <span class="op">==</span><span class="st"> &quot;Professionals&quot;</span>,</a>
<a class="sourceLine" id="cb32-7" data-line-number="7">         <span class="op">!</span><span class="kw">is.na</span>(median_income),</a>
<a class="sourceLine" id="cb32-8" data-line-number="8">         <span class="op">!</span>gender <span class="op">==</span><span class="st"> &quot;Persons&quot;</span>) </a>
<a class="sourceLine" id="cb32-9" data-line-number="9"></a>
<a class="sourceLine" id="cb32-10" data-line-number="10"><span class="co"># Show the first six rows of the new dataset</span></a>
<a class="sourceLine" id="cb32-11" data-line-number="11"><span class="kw">head</span>(professionals)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 14
##     sa3 sa3_name sa3_sqkm sa3_income_perc… state occupation occ_short prof 
##   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;
## 1 10102 Queanbe…    6511.               74 NSW   Professio… Professi… Prof…
## 2 10102 Queanbe…    6511.               74 NSW   Professio… Professi… Prof…
## 3 10102 Queanbe…    6511.               74 NSW   Professio… Professi… Prof…
## 4 10103 Snowy M…   14283.                7 NSW   Professio… Professi… Prof…
## 5 10103 Snowy M…   14283.                7 NSW   Professio… Professi… Prof…
## 6 10103 Snowy M…   14283.                7 NSW   Professio… Professi… Prof…
## # … with 6 more variables: gender &lt;chr&gt;, year &lt;dbl&gt;, median_income &lt;dbl&gt;,
## #   average_income &lt;dbl&gt;, total_income &lt;dbl&gt;, workers &lt;dbl&gt;</code></pre>
</div>
<div id="concepts" class="section level2">
<h2><span class="header-section-number">8.3</span> Concepts</h2>
<p>The <code>ggplot2</code> package is based on the <strong>g</strong>rammar of <strong>g</strong>raphics. …</p>
<p>The main ingredients to a <code>ggplot</code> chart are:</p>
<ul>
<li><strong>Data</strong>: what data should be plotted.
<ul>
<li>e.g. <code>data</code></li>
</ul></li>
<li><strong>Aesthetics</strong>: what variables should be linked to what chart elements.
<ul>
<li>e.g. <code>aes(x = population, y = age)</code> to connect the <code>population</code> variable to the <code>x</code> axis, and the <code>age</code> variable to the <code>y</code> axis.</li>
</ul></li>
<li><strong>Geoms</strong>: how the data should be plotted.
<ul>
<li>e.g. <code>geom_point()</code> will produce a scatter plot, <code>geom_col</code> will produce a column chart, <code>geom_line()</code> will produce a line chart.</li>
</ul></li>
</ul>
<p>Each plot you make will be made up of these three elements. The <a href="https://ggplot2.tidyverse.org/reference/">full list of standard geoms</a> is listed in the <code>tidyverse</code> documentation.</p>
<p><code>ggplot</code> also has a ‘cheat sheet’ that contains many of the often-used elements of a plot, which you can download <a href="https://github.com/rstudio/cheatsheets/raw/master/data-visualization-2.1.pdf">here</a>.</p>
<p><img src="atlas/ggplot_cheat_sheet.png" width="615" style="display: block; margin: auto;" /></p>
<p>For example, you can plot a column chart by passing the <code>sa3_income</code> dataset into <code>ggplot()</code> (“make a chart with this data”). This completes the first step – data – and produces an empty plot:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">professionals <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="st">        </span><span class="kw">ggplot</span>()</a></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/empty_plot-1.png" width="672" /></p>
<p>Next, set the <code>aes</code> (aesthetics) to <code>x = state</code> (“make the x-axis represent state”), <code>y = pop</code> (“the y-axis should represent population”), and <code>fill = year</code> (“the fill colour represents year”). Now <code>ggplot</code> knows where things should <em>go</em>.</p>
<p>If we just plot that, you’ll see that <code>ggplot</code> knows a little bit more about what we’re trying to do. It has the states on the x-axis and range of populations on the y-axis:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">professionals <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> workers,</a>
<a class="sourceLine" id="cb35-3" data-line-number="3">                   <span class="dt">y =</span> median_income,</a>
<a class="sourceLine" id="cb35-4" data-line-number="4">                   <span class="dt">colour =</span> gender))</a></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/empty_aes-1.png" width="672" /></p>
<p>Now that <code>ggplot</code> knows where things should go, it needs to how to <em>plot</em> them on the chart. For this we use <code>geoms</code>. Tell <code>ggplot</code> to take the things it knows and plot them as a column chart by using <code>geom_col</code>:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">professionals <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> workers,</a>
<a class="sourceLine" id="cb36-3" data-line-number="3">                   <span class="dt">y =</span> median_income,</a>
<a class="sourceLine" id="cb36-4" data-line-number="4">                   <span class="dt">colour =</span> gender)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-5" data-line-number="5"><span class="st">        </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/complete_plot-1.png" width="672" /></p>
<p>Great! There are a couple of quick things we can do to make the chart a bit clearer. There are points for each group in each year, which we probably don’t need. So filter the data before you pass it to <code>ggplot</code> to just include 2015: <code>filter(year == 2015)</code>. There will still be lots of overlapping points, so set the opacity to below one with <code>alpha = 0.5</code>. The <code>workers</code> x-axis can be changed to a log scale with <code>scale_x_log10</code>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">professionals <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> workers,</a>
<a class="sourceLine" id="cb37-3" data-line-number="3">                   <span class="dt">y =</span> median_income,</a>
<a class="sourceLine" id="cb37-4" data-line-number="4">                   <span class="dt">colour =</span> gender)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb37-5" data-line-number="5"><span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb37-6" data-line-number="6"><span class="st">        </span><span class="kw">scale_x_log10</span>()</a></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/with_changes-1.png" width="672" /></p>
<p>That looks a bit better. The following sections in this chapter will cover a broad range of charts and designs, but they will all use the same building-blocks of <code>data</code>, <code>aes</code>, and <code>geom</code>.</p>
<p>The rest of the chapter will explore:</p>
<ul>
<li>Exploratory data visualisation</li>
<li>Grattanising your charts and choosing colours</li>
<li>Saving charts according to Grattan templates</li>
<li>Making bar, line, scatter and distribution plots</li>
<li>Making maps and interactive charts</li>
<li>Adding chart labels</li>
</ul>
</div>
<div id="exploratory-data-visualisation" class="section level2">
<h2><span class="header-section-number">8.4</span> Exploratory data visualisation</h2>
<p>Plotting your data early in the analysis stage can help you quickly identify outliers, oddities, things that don’t look quite right.</p>
</div>
<div id="making-grattan-y-charts" class="section level2">
<h2><span class="header-section-number">8.5</span> Making Grattan-y charts</h2>
<p>The <code>grattantheme</code> package contains functions that help <em>Grattanise</em> your charts. It is hosted here: <a href="https://github.com/mattcowgill/grattantheme" class="uri">https://github.com/mattcowgill/grattantheme</a></p>
<p>You can install it with <code>remotes::install_github</code> from the package:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">&quot;remotes&quot;</span>)</a>
<a class="sourceLine" id="cb38-2" data-line-number="2">remotes<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;mattcowgill/grattantheme&quot;</span>)</a></code></pre></div>
<p>The key functions of <code>grattantheme</code> are:</p>
<ul>
<li><code>theme_grattan</code>: set size, font and colour defaults that adhere to the Grattan style guide.</li>
<li><code>grattan_y_continuous</code>: sets the right defaults for a continuous y-axis.</li>
<li><code>grattan_colour_continuous</code>: pulls colours from the Grattan colour palette for <code>colour</code> aesthetics.</li>
<li><code>grattan_fill_continuous</code>: pulls colours from the Grattan colour palette for <code>fill</code> aesthetics.</li>
<li><code>grattan_save</code>: a save function that exports charts in correct report or presentation dimensions.</li>
</ul>
<p>This section will run through some examples of <em>Grattanising</em> charts. The <code>ggplot</code> functions are explored in more detail in the next section.</p>
<div id="making-grattan-charts" class="section level3">
<h3><span class="header-section-number">8.5.1</span> Making Grattan charts</h3>
<p>Start with a scatterplot, similar to the one made above:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">base_chart &lt;-<span class="st"> </span>professionals <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> workers,</a>
<a class="sourceLine" id="cb39-3" data-line-number="3">                   <span class="dt">y =</span> median_income,</a>
<a class="sourceLine" id="cb39-4" data-line-number="4">                   <span class="dt">colour =</span> gender)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-5" data-line-number="5"><span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-6" data-line-number="6"><span class="st">        </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;More professionals, the more they earn&quot;</span>,</a>
<a class="sourceLine" id="cb39-7" data-line-number="7">             <span class="dt">subtitle =</span> <span class="st">&quot;Median income of professional workers in SA3s&quot;</span>,</a>
<a class="sourceLine" id="cb39-8" data-line-number="8">             <span class="dt">x =</span> <span class="st">&quot;Number of professional workers&quot;</span>,</a>
<a class="sourceLine" id="cb39-9" data-line-number="9">             <span class="dt">y =</span> <span class="st">&quot;Median income&quot;</span>,</a>
<a class="sourceLine" id="cb39-10" data-line-number="10">             <span class="dt">caption =</span> <span class="st">&quot;Source: ABS Estimates of Personal Income for Small Areas, 2011-2016&quot;</span>)</a>
<a class="sourceLine" id="cb39-11" data-line-number="11"></a>
<a class="sourceLine" id="cb39-12" data-line-number="12">base_chart</a></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/base_chart-1.png" width="672" /></p>
<p>Let’s make it Grattany. First, add <code>theme_grattan</code> to your plot:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">base_chart <span class="op">+</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="st">        </span><span class="kw">theme_grattan</span>(<span class="dt">chart_type =</span> <span class="st">&quot;scatter&quot;</span>)</a></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/add_theme_grattan-1.png" width="672" /></p>
<p>Then use <code>grattan_y_continuous</code> to adjust the y-axis. This takes the same arguments as the standard <code>scale_y_continuous</code> function, but has Grattan defaults built in. Use it to set the labels as dollars (with <code>scales::dollar()</code>) and to give the y-axis some breathing room (starting at $50,000 rather than the minimum point).
Also add <code>scale_x_log10</code> to make the x-axis a log10 scale, telling it to format the labels as numbers with commas (using <code>scales::comma()</code>).<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">base_chart <span class="op">+</span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="st">        </span><span class="kw">theme_grattan</span>(<span class="dt">chart_type =</span> <span class="st">&quot;scatter&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="st">        </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> dollar, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">50e3</span>, <span class="ot">NA</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-4" data-line-number="4"><span class="st">        </span><span class="kw">scale_x_log10</span>(<span class="dt">labels =</span> comma) </a></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/add_grattan_y_continuous-1.png" width="672" /></p>
<p>To define <code>colour</code> colours, use <code>grattan_colour_manual</code> with the number of colours you need (two, in this case):</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">prof_chart &lt;-<span class="st"> </span>base_chart <span class="op">+</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="st">        </span><span class="kw">theme_grattan</span>(<span class="dt">chart_type =</span> <span class="st">&quot;scatter&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-3" data-line-number="3"><span class="st">        </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> dollar, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">50e3</span>, <span class="ot">NA</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-4" data-line-number="4"><span class="st">        </span><span class="kw">scale_x_log10</span>(<span class="dt">labels =</span> comma) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-5" data-line-number="5"><span class="st">        </span><span class="kw">grattan_colour_manual</span>(<span class="dv">2</span>) </a>
<a class="sourceLine" id="cb42-6" data-line-number="6"></a>
<a class="sourceLine" id="cb42-7" data-line-number="7">prof_chart</a></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/add_fill-1.png" width="672" /></p>
<p>Nice chart! Now you can save it and share it with the world.</p>
</div>
<div id="saving-grattan-charts" class="section level3">
<h3><span class="header-section-number">8.5.2</span> Saving Grattan charts</h3>
<p>The <code>grattan_save</code> function saves your charts according to Grattan templates. It takes these arguments:</p>
<ul>
<li><code>filename</code>: the path, name and file-type of your saved chart. eg: <code>&quot;atlas/professionals_chart.pdf&quot;</code>.</li>
<li><code>object</code>: the R object that you want to save. eg: <code>prof_chart</code>. If left blank, it grabs the last chart that was displayed.</li>
<li><code>type</code>: the Grattan template to be used. This is one of:
<ul>
<li><code>&quot;normal&quot;</code> The default. Use for normal Grattan report charts, or to paste into a 4:3 PowerPoint slide. Width: 22.2cm, height: 14.5cm.</li>
<li><code>&quot;normal_169&quot;</code> Only useful for pasting into a 16:9 format Grattan PowerPoint slide. Width: 30cm, height: 14.5cm.</li>
<li><code>&quot;tiny&quot;</code> Fills the width of a column in a Grattan report, but is shorter than usual. Width: 22.2cm, height: 11.1cm.</li>
<li><code>&quot;wholecolumn&quot;</code> Takes up a whole column in a Grattan report. Width: 22.2cm, height: 22.2cm.</li>
<li><code>&quot;fullpage&quot;</code> Fills a whole page of a Grattan report. Width: 44.3cm, height: 22.2cm.</li>
<li><code>&quot;fullslide&quot;</code> Creates an image that looks like a 4:3 Grattan PowerPoint slide, complete with logo. Width: 25.4cm, height: 19.0cm.</li>
<li><code>&quot;fullslide_169&quot;</code> Creates` an image that looks like a 16:9 Grattan PowerPoint slide, complete with logo. Use this to drop into standard presentations. Width: 33.9cm, height: 19.0cm</li>
<li><code>&quot;blog&quot;</code> Creates a 4:3 image that looks like a Grattan PowerPoint slide, but with less border whitespace than ‘fullslide’.&quot;</li>
<li><code>&quot;fullslide_44&quot; Creates</code> an image that looks like a 4:4 Grattan PowerPoint slide. This may be useful for taller charts for the Grattan blog; not useful for any other purpose. Width: 25.4cm, height: 25.4cm.</li>
<li>Set <code>type = &quot;all&quot;</code> to save your chart in all available sizes.</li>
</ul></li>
<li><code>height</code>: override the height set by <code>type</code>. This can be useful for really long charts in blogposts.</li>
<li><code>save_data</code>: exports a <code>csv</code> file containing the data used in the chart.</li>
<li><code>force_labs</code>: override the removal of labels for a particular <code>type</code>. eg <code>force_labs = TRUE</code> will keep the y-axis label.</li>
</ul>
<p>To save the <code>prof_chart</code> plot created above as a whole-column chart for a <strong>report</strong>:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">grattan_save</span>(<span class="st">&quot;atlas/professionals_chart_report.pdf&quot;</span>, prof_chart, <span class="dt">type =</span> <span class="st">&quot;wholecolumn&quot;</span>)</a></code></pre></div>
<!--- background: include=FALSE, echo=FALSE, results=FALSE ---->
<p><img src="atlas/professionals_chart_report.png" width="1396" /></p>
<p>To save it as a <strong>presentation</strong> slide instead, use <code>type = &quot;fullslide&quot;</code>:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw">grattan_save</span>(<span class="st">&quot;atlas/professionals_chart_presentation.pdf&quot;</span>, prof_chart, <span class="dt">type =</span> <span class="st">&quot;fullslide&quot;</span>)</a></code></pre></div>
<!--- background: include=FALSE, echo=FALSE, results=FALSE ---->
<p><img src="atlas/professionals_chart_presentation.png" width="1600" /></p>
<p>Or, if you want to emphasise the point in a <em>really tall</em> chart for a <strong>blogpost</strong>, you can use <code>type = &quot;blog&quot;</code> and adjust the <code>height</code> to be 50cm. Also note that because this is for the blog, you should save it as a <code>png</code> file:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="kw">grattan_save</span>(<span class="st">&quot;atlas/professionals_chart_blog.png&quot;</span>, prof_chart, </a>
<a class="sourceLine" id="cb45-2" data-line-number="2">             <span class="dt">type =</span> <span class="st">&quot;blog&quot;</span>, <span class="dt">height =</span> <span class="dv">30</span>)</a></code></pre></div>
<!--- background: include=FALSE, echo=FALSE, results=FALSE ---->
<p><img src="atlas/professionals_chart_blog.png" width="1600" /></p>
<p>And that’s it! The following sections will go into more detail about different chart types in R, but you’ll mostly use the same basic <code>grattantheme</code> formatting you’ve used here.</p>
</div>
</div>
<div id="adding-labels" class="section level2">
<h2><span class="header-section-number">8.6</span> Adding labels</h2>
<p>Labels can be a bit finicky – especially compared to labelling charts visually in PowerPoint. …</p>
<p>Labels can be done in two broad ways:</p>
<ol style="list-style-type: decimal">
<li>Labelling every single data point on your chart. Grattan charts rarely do this.</li>
<li>Labelling some of the data points on your chart. This is how you label Grattan charts: label on item in a group and let the reader join the dots.</li>
</ol>
<p>We’ll look at the first approach so you can get a feel for how the labelling geoms – <code>geom_label</code> and <code>geom_text</code> (and some useful extensions) – work. It won’t be pretty.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">prof_chart <span class="op">+</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> gender))</a></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/add_annotate-1.png" width="672" /></p>
<p>Great! That looks <em>terrible</em>. <code>geom_text</code> is labelling each individual point because it has been told to do so. Just like <code>geom_point</code>, it takes the <code>x</code> and <code>y</code> aesthetics of each observation, then plots the <code>label</code> at that location. But we just want to label one of the points for <code>female</code> and one for <code>male</code>.</p>
<p>To do this, we can create a new dataset that just contains one observation each. Here, you’re filtering the dataset to include <em>only</em> the female/male observations that have the most people:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1">label_data &lt;-<span class="st"> </span>professionals <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(gender) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(workers <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(workers)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-4" data-line-number="4"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb47-5" data-line-number="5"></a>
<a class="sourceLine" id="cb47-6" data-line-number="6">label_data</a></code></pre></div>
<pre><code>## # A tibble: 2 x 14
##     sa3 sa3_name sa3_sqkm sa3_income_perc… state occupation occ_short prof 
##   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;
## 1 11703 Sydney …     25.1               84 NSW   Professio… Professi… Prof…
## 2 11703 Sydney …     25.1               84 NSW   Professio… Professi… Prof…
## # … with 6 more variables: gender &lt;chr&gt;, year &lt;dbl&gt;, median_income &lt;dbl&gt;,
## #   average_income &lt;dbl&gt;, total_income &lt;dbl&gt;, workers &lt;dbl&gt;</code></pre>
<p>And then tell <code>geom_text</code> to look at <em>that</em> dataset:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">prof_chart <span class="op">+</span></a>
<a class="sourceLine" id="cb49-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> label_data,</a>
<a class="sourceLine" id="cb49-3" data-line-number="3">            <span class="kw">aes</span>(<span class="dt">label =</span> gender))</a></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Okay, not bad. The labels go off the chart. You could fix this by shortening the labels either inside the <code>label_data</code>:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">label_data_short &lt;-<span class="st"> </span>label_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gender_label =</span> <span class="kw">if_else</span>(gender <span class="op">==</span><span class="st"> &quot;Females&quot;</span>, </a>
<a class="sourceLine" id="cb50-3" data-line-number="3">                             <span class="st">&quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb50-4" data-line-number="4">                             <span class="st">&quot;Men&quot;</span>))</a>
<a class="sourceLine" id="cb50-5" data-line-number="5"></a>
<a class="sourceLine" id="cb50-6" data-line-number="6">prof_chart <span class="op">+</span></a>
<a class="sourceLine" id="cb50-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> label_data_short,</a>
<a class="sourceLine" id="cb50-8" data-line-number="8">            <span class="kw">aes</span>(<span class="dt">label =</span> gender_label))</a></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p><em>Or</em> you could adjust the label values directly inside the aesthetics call. Note that this means you have to provide a vector that is the same length as the number of observations in the data (a length of two, in this case).</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1">prof_chart <span class="op">+</span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> label_data,</a>
<a class="sourceLine" id="cb51-3" data-line-number="3">            <span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">c</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>)))</a></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>To have more freedom over <em>where</em> your labels are placed, you can create a dataset yourself. Add the <code>x</code> and <code>y</code> values for your labels, and the label names.<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">self_label &lt;-<span class="st"> </span><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb52-2" data-line-number="2">  <span class="op">~</span>gender, <span class="op">~</span>workers,   <span class="op">~</span>median_income,</a>
<a class="sourceLine" id="cb52-3" data-line-number="3">  <span class="st">&quot;Women&quot;</span>,    <span class="dv">23000</span>,            <span class="dv">55000</span>,</a>
<a class="sourceLine" id="cb52-4" data-line-number="4">  <span class="st">&quot;Men&quot;</span>,      <span class="dv">23000</span>,           <span class="dv">110000</span>)</a>
<a class="sourceLine" id="cb52-5" data-line-number="5"></a>
<a class="sourceLine" id="cb52-6" data-line-number="6"></a>
<a class="sourceLine" id="cb52-7" data-line-number="7">self_label</a></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   gender workers median_income
##   &lt;chr&gt;    &lt;dbl&gt;         &lt;dbl&gt;
## 1 Women    23000         55000
## 2 Men      23000        110000</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1">prof_chart <span class="op">+</span></a>
<a class="sourceLine" id="cb54-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> self_label,</a>
<a class="sourceLine" id="cb54-3" data-line-number="3">            <span class="kw">aes</span>(<span class="dt">label =</span> gender), </a>
<a class="sourceLine" id="cb54-4" data-line-number="4">            <span class="dt">hjust =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>[cover <code>annotate</code>]</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="6">
<li id="fn6"><p>From Kieran Healy’s <a href="https://socviz.co/"><em>Data Vizualization: A Practical Introduction</em></a>: ‘You should look at your data. Graphs and charts let you explore and learn about the structure of the information you collect. Good data visualizations also make it easier to communicate your ideas and findings to other people.’<a href="data-visualisation.html#fnref6" class="footnote-back">↩</a></p></li>
<li id="fn7"><p>‘Bar charts are evidence that you are dead inside’ – Amanda Cox, data editor for the New York Times.<a href="data-visualisation.html#fnref7" class="footnote-back">↩</a></p></li>
<li id="fn8"><p>From <a href="https://www.abs.gov.au/AUSSTATS/abs@.nsf/DetailsPage/6524.0.55.0022011-2016?OpenDocument">ABS Employee income by occupation and gender, 2010-11 to 2015-16</a><a href="data-visualisation.html#fnref8" class="footnote-back">↩</a></p></li>
<li id="fn9"><p>The <code>dollar</code> and <code>comma</code> commands are functions, but can be used without <code>()</code>. Using <code>dollar()</code> or <code>comma()</code> works too, and you can provide arguments that adjust their output: eg <code>dollar(suffix = &quot;million&quot;)</code><a href="data-visualisation.html#fnref9" class="footnote-back">↩</a></p></li>
<li id="fn10"><p>We are using the <code>tribble</code> function here to make it a little bit clearer what values apply to which gender. The ‘normal’ way to create a tibble is with the <code>tibble</code> function: <br> <code>tibble(x = c(10, 100), y = c(100, 10))</code>, etc.<a href="data-visualisation.html#fnref10" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-tidyverse.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chart-cookbook.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["r-at-grattan.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
