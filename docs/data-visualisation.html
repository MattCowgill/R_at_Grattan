<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Data Visualisation | Using R at Grattan Institute</title>
  <meta name="description" content="How to use R at Grattan good. In development." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Data Visualisation | Using R at Grattan Institute" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="How to use R at Grattan good. In development." />
  <meta name="github-repo" content="grattan/R_at_Grattan" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Data Visualisation | Using R at Grattan Institute" />
  
  <meta name="twitter:description" content="How to use R at Grattan good. In development." />
  

<meta name="author" content="Will Mackey and Matt Cowgill" />


<meta name="date" content="2019-09-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="organising-an-r-project-at-grttan.html"/>
<link rel="next" href="reading-data.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Using R at Grattan Institute</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#what-is-r"><i class="fa fa-check"></i><b>1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#what-is-rstudio"><i class="fa fa-check"></i><b>1.2</b> What is RStudio?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>1.3</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#packages"><i class="fa fa-check"></i><b>1.4</b> Packages</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#installing-packages"><i class="fa fa-check"></i><b>1.4.1</b> Installing packages</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#using-packages"><i class="fa fa-check"></i><b>1.4.2</b> Using packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="why-use-r.html"><a href="why-use-r.html"><i class="fa fa-check"></i><b>2</b> Why use R?</a><ul>
<li class="chapter" data-level="2.1" data-path="why-use-r.html"><a href="why-use-r.html#why-script"><i class="fa fa-check"></i><b>2.1</b> Why use script-based software?</a></li>
<li class="chapter" data-level="2.2" data-path="why-use-r.html"><a href="why-use-r.html#why-R"><i class="fa fa-check"></i><b>2.2</b> Why use R specifically?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-tidyverse.html"><a href="the-tidyverse.html"><i class="fa fa-check"></i><b>3</b> The tidyverse</a><ul>
<li class="chapter" data-level="3.1" data-path="the-tidyverse.html"><a href="the-tidyverse.html#what-is-the-tidyverse-and-why-do-we-use-it"><i class="fa fa-check"></i><b>3.1</b> What is the tidyverse and why do we use it?</a></li>
<li class="chapter" data-level="3.2" data-path="the-tidyverse.html"><a href="the-tidyverse.html#an-introduction-to-rmarkdown"><i class="fa fa-check"></i><b>3.2</b> An introduction to RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="organising-an-r-project-at-grttan.html"><a href="organising-an-r-project-at-grttan.html"><i class="fa fa-check"></i><b>4</b> Organising an R project at Grttan</a><ul>
<li class="chapter" data-level="4.1" data-path="organising-an-r-project-at-grttan.html"><a href="organising-an-r-project-at-grttan.html#use-rstudio-projects-dont-use-setwd"><i class="fa fa-check"></i><b>4.1</b> Use RStudio projects, don’t use <code>setwd()</code></a></li>
<li class="chapter" data-level="4.2" data-path="organising-an-r-project-at-grttan.html"><a href="organising-an-r-project-at-grttan.html#keep-your-stuff-together-but-keep-it-organised"><i class="fa fa-check"></i><b>4.2</b> Keep your stuff together, but keep it organised</a><ul>
<li class="chapter" data-level="4.2.1" data-path="organising-an-r-project-at-grttan.html"><a href="organising-an-r-project-at-grttan.html#filepaths"><i class="fa fa-check"></i><b>4.2.1</b> Filepaths</a></li>
<li class="chapter" data-level="4.2.2" data-path="organising-an-r-project-at-grttan.html"><a href="organising-an-r-project-at-grttan.html#keep-your-scripts-manageable"><i class="fa fa-check"></i><b>4.2.2</b> Keep your scripts manageable</a></li>
<li class="chapter" data-level="4.2.3" data-path="organising-an-r-project-at-grttan.html"><a href="organising-an-r-project-at-grttan.html#use-subfolders-of-your-project-folder"><i class="fa fa-check"></i><b>4.2.3</b> Use subfolders of your project folder</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="organising-an-r-project-at-grttan.html"><a href="organising-an-r-project-at-grttan.html#grattan-coding-style-guide"><i class="fa fa-check"></i><b>4.3</b> Grattan coding style guide</a></li>
<li class="chapter" data-level="4.4" data-path="organising-an-r-project-at-grttan.html"><a href="organising-an-r-project-at-grttan.html#resources-in-this-package"><i class="fa fa-check"></i><b>4.4</b> Resources in this package</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-visualisation.html"><a href="data-visualisation.html"><i class="fa fa-check"></i><b>5</b> Data Visualisation</a><ul>
<li class="chapter" data-level="5.1" data-path="data-visualisation.html"><a href="data-visualisation.html#set-up-and-packages"><i class="fa fa-check"></i><b>5.1</b> Set-up and packages</a></li>
<li class="chapter" data-level="5.2" data-path="data-visualisation.html"><a href="data-visualisation.html#concepts"><i class="fa fa-check"></i><b>5.2</b> Concepts</a></li>
<li class="chapter" data-level="5.3" data-path="data-visualisation.html"><a href="data-visualisation.html#making-grattan-y-charts"><i class="fa fa-check"></i><b>5.3</b> Making Grattan-y charts</a><ul>
<li class="chapter" data-level="5.3.1" data-path="data-visualisation.html"><a href="data-visualisation.html#making-grattan-charts"><i class="fa fa-check"></i><b>5.3.1</b> Making Grattan charts</a></li>
<li class="chapter" data-level="5.3.2" data-path="data-visualisation.html"><a href="data-visualisation.html#saving-grattan-charts"><i class="fa fa-check"></i><b>5.3.2</b> Saving Grattan charts</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-visualisation.html"><a href="data-visualisation.html#chart-cookbook"><i class="fa fa-check"></i><b>5.4</b> Chart cookbook</a><ul>
<li class="chapter" data-level="5.4.1" data-path="data-visualisation.html"><a href="data-visualisation.html#bar-charts"><i class="fa fa-check"></i><b>5.4.1</b> Bar charts</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-visualisation.html"><a href="data-visualisation.html#line-charts"><i class="fa fa-check"></i><b>5.4.2</b> Line charts</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-visualisation.html"><a href="data-visualisation.html#scatter-plots"><i class="fa fa-check"></i><b>5.4.3</b> Scatter plots</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-visualisation.html"><a href="data-visualisation.html#distributions"><i class="fa fa-check"></i><b>5.4.4</b> Distributions</a></li>
<li class="chapter" data-level="5.4.5" data-path="data-visualisation.html"><a href="data-visualisation.html#maps"><i class="fa fa-check"></i><b>5.4.5</b> Maps</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-visualisation.html"><a href="data-visualisation.html#creating-simple-interactive-graphs-with-plotly"><i class="fa fa-check"></i><b>5.5</b> Creating simple interactive graphs with <code>plotly</code></a></li>
<li class="chapter" data-level="5.6" data-path="data-visualisation.html"><a href="data-visualisation.html#bin-generate-data-used-before-prior-sections-are-constructed"><i class="fa fa-check"></i><b>5.6</b> bin: generate data used (before prior sections are constructed)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reading-data.html"><a href="reading-data.html"><i class="fa fa-check"></i><b>6</b> Reading data</a><ul>
<li class="chapter" data-level="6.1" data-path="reading-data.html"><a href="reading-data.html#importing-data"><i class="fa fa-check"></i><b>6.1</b> Importing data</a><ul>
<li class="chapter" data-level="6.1.1" data-path="reading-data.html"><a href="reading-data.html#reading-csv-files"><i class="fa fa-check"></i><b>6.1.1</b> Reading CSV files</a></li>
<li class="chapter" data-level="6.1.2" data-path="reading-data.html"><a href="reading-data.html#readxlread_excel"><i class="fa fa-check"></i><b>6.1.2</b> <code>readxl::read_excel()</code></a></li>
<li class="chapter" data-level="6.1.3" data-path="reading-data.html"><a href="reading-data.html#rio"><i class="fa fa-check"></i><b>6.1.3</b> <code>rio</code></a></li>
<li class="chapter" data-level="6.1.4" data-path="reading-data.html"><a href="reading-data.html#readabs"><i class="fa fa-check"></i><b>6.1.4</b> <code>readabs</code></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="reading-data.html"><a href="reading-data.html#reading-common-files"><i class="fa fa-check"></i><b>6.2</b> Reading common files:</a></li>
<li class="chapter" data-level="6.3" data-path="reading-data.html"><a href="reading-data.html#appropriately-renaming-variables"><i class="fa fa-check"></i><b>6.3</b> Appropriately renaming variables</a></li>
<li class="chapter" data-level="6.4" data-path="reading-data.html"><a href="reading-data.html#getting-to-tidy-data"><i class="fa fa-check"></i><b>6.4</b> Getting to tidy data</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="different-data-types.html"><a href="different-data-types.html"><i class="fa fa-check"></i><b>7</b> Different data types</a><ul>
<li class="chapter" data-level="7.1" data-path="different-data-types.html"><a href="different-data-types.html#tidy-data"><i class="fa fa-check"></i><b>7.1</b> Tidy data</a></li>
<li class="chapter" data-level="7.2" data-path="different-data-types.html"><a href="different-data-types.html#dates-with-lubridate"><i class="fa fa-check"></i><b>7.2</b> Dates with <code>lubridate::</code></a></li>
<li class="chapter" data-level="7.3" data-path="different-data-types.html"><a href="different-data-types.html#strings-with-stringr"><i class="fa fa-check"></i><b>7.3</b> Strings with <code>stringr::</code></a></li>
<li class="chapter" data-level="7.4" data-path="different-data-types.html"><a href="different-data-types.html#factors-with-forcats"><i class="fa fa-check"></i><b>7.4</b> Factors with <code>forcats::</code></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>8</b> Data transformation</a><ul>
<li class="chapter" data-level="8.1" data-path="data-transformation.html"><a href="data-transformation.html#the-pipe"><i class="fa fa-check"></i><b>8.1</b> The pipe</a></li>
<li class="chapter" data-level="8.2" data-path="data-transformation.html"><a href="data-transformation.html#key-dplyr-functions"><i class="fa fa-check"></i><b>8.2</b> Key <code>dplyr</code> functions:</a></li>
<li class="chapter" data-level="8.3" data-path="data-transformation.html"><a href="data-transformation.html#filter-with-filter"><i class="fa fa-check"></i><b>8.3</b> Filter with <code>filter()</code></a></li>
<li class="chapter" data-level="8.4" data-path="data-transformation.html"><a href="data-transformation.html#arrange-with-arrange"><i class="fa fa-check"></i><b>8.4</b> Arrange with <code>arrange()</code></a></li>
<li class="chapter" data-level="8.5" data-path="data-transformation.html"><a href="data-transformation.html#select-variables-with-select"><i class="fa fa-check"></i><b>8.5</b> Select variables with <code>select()</code></a></li>
<li class="chapter" data-level="8.6" data-path="data-transformation.html"><a href="data-transformation.html#group-data-with-group_by"><i class="fa fa-check"></i><b>8.6</b> Group data with <code>group_by()</code></a></li>
<li class="chapter" data-level="8.7" data-path="data-transformation.html"><a href="data-transformation.html#edit-and-add-new-variables-with-mutate"><i class="fa fa-check"></i><b>8.7</b> Edit and add new variables with <code>mutate()</code></a><ul>
<li class="chapter" data-level="8.7.1" data-path="data-transformation.html"><a href="data-transformation.html#cases-when-you-should-use-case_when"><i class="fa fa-check"></i><b>8.7.1</b> Cases when you should use <code>case_when()</code></a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="data-transformation.html"><a href="data-transformation.html#summarise-data-with-summarise"><i class="fa fa-check"></i><b>8.8</b> Summarise data with <code>summarise()</code></a></li>
<li class="chapter" data-level="8.9" data-path="data-transformation.html"><a href="data-transformation.html#joining-datasets-with-_join"><i class="fa fa-check"></i><b>8.9</b> Joining datasets with <code>*_join()</code></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="analysis.html"><a href="analysis.html"><i class="fa fa-check"></i><b>9</b> Analysis</a></li>
<li class="chapter" data-level="10" data-path="creating-functions.html"><a href="creating-functions.html"><i class="fa fa-check"></i><b>10</b> Creating functions</a><ul>
<li class="chapter" data-level="10.1" data-path="creating-functions.html"><a href="creating-functions.html#it-can-be-useful-to-make-your-own-function"><i class="fa fa-check"></i><b>10.1</b> It can be useful to make your own function</a></li>
<li class="chapter" data-level="10.2" data-path="creating-functions.html"><a href="creating-functions.html#defining-simple-functions"><i class="fa fa-check"></i><b>10.2</b> Defining simple functions</a></li>
<li class="chapter" data-level="10.3" data-path="creating-functions.html"><a href="creating-functions.html#more-complex-functions"><i class="fa fa-check"></i><b>10.3</b> More complex functions</a></li>
<li class="chapter" data-level="10.4" data-path="creating-functions.html"><a href="creating-functions.html#sets-of-functions"><i class="fa fa-check"></i><b>10.4</b> Sets of functions</a></li>
<li class="chapter" data-level="10.5" data-path="creating-functions.html"><a href="creating-functions.html#using-purrrmap"><i class="fa fa-check"></i><b>10.5</b> Using <code>purrr::map</code></a></li>
<li class="chapter" data-level="10.6" data-path="creating-functions.html"><a href="creating-functions.html#sharing-your-useful-functions-with-grattan"><i class="fa fa-check"></i><b>10.6</b> Sharing your useful functions with Grattan</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="version-control.html"><a href="version-control.html"><i class="fa fa-check"></i><b>11</b> Version control</a><ul>
<li class="chapter" data-level="11.1" data-path="version-control.html"><a href="version-control.html#version-control-is-important-and-intimidating"><i class="fa fa-check"></i><b>11.1</b> Version control is important and intimidating</a></li>
<li class="chapter" data-level="11.2" data-path="version-control.html"><a href="version-control.html#github"><i class="fa fa-check"></i><b>11.2</b> Github</a></li>
<li class="chapter" data-level="11.3" data-path="version-control.html"><a href="version-control.html#git"><i class="fa fa-check"></i><b>11.3</b> Git</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using R at Grattan Institute</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-visualisation" class="section level1">
<h1><span class="header-section-number">5</span> Data Visualisation</h1>
<p>[intro]</p>
<div id="set-up-and-packages" class="section level2">
<h2><span class="header-section-number">5.1</span> Set-up and packages</h2>
<p>This section uses the package <code>ggplot2</code> to visualise data, and <code>dplyr</code> functions to manipulate data. Both of these packages are loaded with <code>tidyverse</code>. The <code>scales</code> package helps with labelling your axes.</p>
<p>The <code>grattantheme</code> package is used to make charts look Grattan-y. The <code>absmapsdata</code> package is used to help make maps.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="data-visualisation.html#cb8-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb8-2"><a href="data-visualisation.html#cb8-2"></a><span class="kw">library</span>(grattantheme)</span>
<span id="cb8-3"><a href="data-visualisation.html#cb8-3"></a><span class="kw">library</span>(absmapsdata)</span>
<span id="cb8-4"><a href="data-visualisation.html#cb8-4"></a><span class="kw">library</span>(sf)</span>
<span id="cb8-5"><a href="data-visualisation.html#cb8-5"></a><span class="kw">library</span>(scales)</span></code></pre></div>
<p>For most charts in this chapter, we’ll use the <code>population_table</code> data summarised here. It contains the population in each state between 2013 and 2018:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="data-visualisation.html#cb9-1"></a>population_table &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/population_sa4.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-2"><a href="data-visualisation.html#cb9-2"></a><span class="st">        </span><span class="kw">filter</span>(data_item <span class="op">==</span><span class="st"> &quot;Persons - Total (no.)&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-3"><a href="data-visualisation.html#cb9-3"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">pop =</span> <span class="kw">as.numeric</span>(value),</span>
<span id="cb9-4"><a href="data-visualisation.html#cb9-4"></a>               <span class="dt">year =</span> <span class="kw">as.factor</span>(year)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-5"><a href="data-visualisation.html#cb9-5"></a><span class="st">        </span><span class="kw">group_by</span>(year, state) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-6"><a href="data-visualisation.html#cb9-6"></a><span class="st">        </span><span class="kw">summarise</span>(<span class="dt">pop =</span> <span class="kw">sum</span>(pop))</span>
<span id="cb9-7"><a href="data-visualisation.html#cb9-7"></a></span>
<span id="cb9-8"><a href="data-visualisation.html#cb9-8"></a><span class="co"># Show the first six rows of the new dataset</span></span>
<span id="cb9-9"><a href="data-visualisation.html#cb9-9"></a><span class="kw">head</span>(population_table)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
## # Groups:   year [1]
##   year  state                            pop
##   &lt;fct&gt; &lt;chr&gt;                          &lt;dbl&gt;
## 1 2013  Australian Capital Territory  383257
## 2 2013  New South Wales              7404032
## 3 2013  Northern Territory            241722
## 4 2013  Other Territories               2962
## 5 2013  Queensland                   4652824
## 6 2013  South Australia              1671488</code></pre>
</div>
<div id="concepts" class="section level2">
<h2><span class="header-section-number">5.2</span> Concepts</h2>
<p>The <code>ggplot2</code> package is based on the <code>g</code>rammar of <code>g</code>raphics. …</p>
<p>The main ingredients to a <code>ggplot</code> chart:</p>
<ul>
<li><strong>Data</strong>: what data should be plotted. e.g. <code>data</code></li>
<li><strong>Aesthetics</strong>: what variables should be linked to what chart elements. e.g. <code>aes(x = population, y = age)</code> to connect the <code>population</code> variable to the <code>x</code> axis, and the <code>age</code> variable to the <code>y</code> axis.</li>
<li><strong>Geoms</strong>: how the data should be plotted. e.g. <code>geom_point()</code> will produce a scatter plot, <code>geom_col</code> will produce a column chart.</li>
</ul>
<p>Each plot you make will be made up of these three elements. The <a href="https://ggplot2.tidyverse.org/reference/">full list of standard geoms</a> is listed in the <code>tidyverse</code> documentation.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="data-visualisation.html#cb11-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-2"><a href="data-visualisation.html#cb11-2"></a><span class="st">  </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>(</span>
<span id="cb11-3"><a href="data-visualisation.html#cb11-3"></a>     <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="op">&lt;</span>MAPPINGS<span class="op">&gt;</span>),</span>
<span id="cb11-4"><a href="data-visualisation.html#cb11-4"></a>     <span class="dt">stat =</span> <span class="op">&lt;</span>STAT<span class="op">&gt;</span>, </span>
<span id="cb11-5"><a href="data-visualisation.html#cb11-5"></a>     <span class="dt">position =</span> <span class="op">&lt;</span>POSITION<span class="op">&gt;</span></span>
<span id="cb11-6"><a href="data-visualisation.html#cb11-6"></a><span class="st">  </span>) <span class="op">+</span></span>
<span id="cb11-7"><a href="data-visualisation.html#cb11-7"></a><span class="st">  </span><span class="er">&lt;</span>COORDINATE_FUNCTION<span class="op">&gt;</span><span class="st"> </span><span class="op">+</span></span>
<span id="cb11-8"><a href="data-visualisation.html#cb11-8"></a><span class="st">  </span><span class="er">&lt;</span>FACET_FUNCTION<span class="op">&gt;</span></span></code></pre></div>
<p>For example, you can plot a column chart by passing the <code>population_table</code> dataset into <code>ggplot()</code> (“make a chart wth this data”). This produces an empty plot:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="data-visualisation.html#cb12-1"></a>population_table <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-2"><a href="data-visualisation.html#cb12-2"></a><span class="st">        </span><span class="kw">ggplot</span>()</span></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/empty%20plot-1.png" width="672" /></p>
<p>Next, set the <code>aes</code> (aesthetics) to <code>x = state</code> (“make the x-axis represent state”), <code>y = pop</code> (“the y-axis should represent population”), and <code>fill = year</code> (“the fill colour represents year”). Now <code>ggplot</code> knows where things should <em>go</em>:<code>{r empty with aes} population_table %&gt;%          ggplot(aes(x = state,                    y = pop,                    fill = year))</code></p>
<p>Now that <code>ggplot</code> knows where things should go, it needs to <em>how</em> to plot them. For this we use <code>geoms</code>. Tell it to plot a column chart by using <code>geom_col</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="data-visualisation.html#cb13-1"></a>population_table <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-2"><a href="data-visualisation.html#cb13-2"></a><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> state,</span>
<span id="cb13-3"><a href="data-visualisation.html#cb13-3"></a>                   <span class="dt">y =</span> pop,</span>
<span id="cb13-4"><a href="data-visualisation.html#cb13-4"></a>                   <span class="dt">fill =</span> year)) <span class="op">+</span></span>
<span id="cb13-5"><a href="data-visualisation.html#cb13-5"></a><span class="st">        </span><span class="kw">geom_col</span>()</span></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/complete%20plot-1.png" width="672" /></p>
<p>Great! Although stacking populations is a bit silly. You can adjust the way <code>geoms</code> work with arguments. In this case, tell it to place the different categories next to each other rather than ontop of each other using <code>position = "dodge"</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="data-visualisation.html#cb14-1"></a>population_table <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb14-2"><a href="data-visualisation.html#cb14-2"></a><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> state,</span>
<span id="cb14-3"><a href="data-visualisation.html#cb14-3"></a>                   <span class="dt">y =</span> pop,</span>
<span id="cb14-4"><a href="data-visualisation.html#cb14-4"></a>                   <span class="dt">fill =</span> year)) <span class="op">+</span></span>
<span id="cb14-5"><a href="data-visualisation.html#cb14-5"></a><span class="st">        </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/with%20dodge-1.png" width="672" /></p>
<p>That’s nicer. The following sections in this chapter will build on this chart. The rest of the chapter will explore:</p>
<ul>
<li>Grattanising your charts and choosing colours</li>
<li>Saving charts according to Grattan templates</li>
<li>Making bar, line, scatter and distribution plots</li>
<li>Making maps and interactive charts</li>
<li>Adding chart labels</li>
</ul>
</div>
<div id="making-grattan-y-charts" class="section level2">
<h2><span class="header-section-number">5.3</span> Making Grattan-y charts</h2>
<p>The <code>grattantheme</code> package contains functions that help <em>Grattanise</em> your charts. It is hosted here: <a href="https://github.com/mattcowgill/grattantheme" class="uri">https://github.com/mattcowgill/grattantheme</a></p>
<p>You can install it with <code>devtools::install_github</code> from the package:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="data-visualisation.html#cb15-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb15-2"><a href="data-visualisation.html#cb15-2"></a>remotes<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;mattcowgill/grattantheme&quot;</span>)</span></code></pre></div>
<p>The key functions of <code>grattantheme</code> are:</p>
<ul>
<li><code>theme_grattan</code>: set size, font and colour defaults that adhere to the Grattan style guide.</li>
<li><code>grattan_y_continuous</code>: sets the right defaults for a continuous y-axis.</li>
<li><code>grattan_colour_continuous</code>: pulls colours from the Grattan colour palete for <code>colour</code> aesthetics.</li>
<li><code>grattan_fill_continuous</code>: pulls colours from the Grattan colour palete for <code>fill</code> aesthetics.</li>
<li><code>grattan_save</code>: a save function that exports charts in correct report or presentation dimensions.</li>
</ul>
<p>This section will run through some examples of <em>Grattanising</em> charts. The <code>ggplot</code> functions are explored in more detail in the next section.</p>
<div id="making-grattan-charts" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Making Grattan charts</h3>
<p>Start with a column chart, similar to the one made above:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="data-visualisation.html#cb16-1"></a>base_chart &lt;-<span class="st"> </span>population_table <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-2"><a href="data-visualisation.html#cb16-2"></a><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> state,</span>
<span id="cb16-3"><a href="data-visualisation.html#cb16-3"></a>                   <span class="dt">y =</span> pop,</span>
<span id="cb16-4"><a href="data-visualisation.html#cb16-4"></a>                   <span class="dt">fill =</span> year)) <span class="op">+</span></span>
<span id="cb16-5"><a href="data-visualisation.html#cb16-5"></a><span class="st">        </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></span>
<span id="cb16-6"><a href="data-visualisation.html#cb16-6"></a><span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb16-7"><a href="data-visualisation.html#cb16-7"></a>             <span class="dt">title =</span> <span class="st">&quot;NSW and Victoria are booming&quot;</span>,</span>
<span id="cb16-8"><a href="data-visualisation.html#cb16-8"></a>             <span class="dt">subtitle =</span> <span class="st">&quot;Population by state, 2013-2018&quot;</span>,</span>
<span id="cb16-9"><a href="data-visualisation.html#cb16-9"></a>             <span class="dt">caption =</span> <span class="st">&quot;Source: ABS Regional Dataset (2019)&quot;</span>)</span>
<span id="cb16-10"><a href="data-visualisation.html#cb16-10"></a></span>
<span id="cb16-11"><a href="data-visualisation.html#cb16-11"></a>base_chart</span></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/base_chart-1.png" width="672" /></p>
<p>Let’s make it Grattany. First, add <code>theme_grattan</code> to your plot:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="data-visualisation.html#cb17-1"></a>base_chart <span class="op">+</span></span>
<span id="cb17-2"><a href="data-visualisation.html#cb17-2"></a><span class="st">        </span><span class="kw">theme_grattan</span>()</span></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/add_theme_grattan-1.png" width="672" /></p>
<p>Then <code>grattan_y_continuous</code> to align the x-axis with zero. This function takes the same arguments as <code>scale_y_continuous</code>, so you can add <code>labels = comma()</code> to reformat the y-axis labels:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="data-visualisation.html#cb18-1"></a>base_chart <span class="op">+</span></span>
<span id="cb18-2"><a href="data-visualisation.html#cb18-2"></a><span class="st">        </span><span class="kw">theme_grattan</span>() <span class="op">+</span></span>
<span id="cb18-3"><a href="data-visualisation.html#cb18-3"></a><span class="st">        </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> comma)</span></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/add_grattan_y_continuous-1.png" width="672" /></p>
<p>To define <code>fill</code> colours, use <code>grattan_fill_manual</code> with the number of colours you need (six, in this case):</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="data-visualisation.html#cb19-1"></a>pop_chart &lt;-<span class="st"> </span>base_chart <span class="op">+</span></span>
<span id="cb19-2"><a href="data-visualisation.html#cb19-2"></a><span class="st">        </span><span class="kw">theme_grattan</span>() <span class="op">+</span></span>
<span id="cb19-3"><a href="data-visualisation.html#cb19-3"></a><span class="st">        </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> comma) <span class="op">+</span></span>
<span id="cb19-4"><a href="data-visualisation.html#cb19-4"></a><span class="st">        </span><span class="kw">grattan_fill_manual</span>(<span class="dv">6</span>)</span>
<span id="cb19-5"><a href="data-visualisation.html#cb19-5"></a></span>
<span id="cb19-6"><a href="data-visualisation.html#cb19-6"></a>pop_chart</span></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/add_fill-1.png" width="672" /></p>
<p>Nice chart! Now you can save it and share it with the world.</p>
</div>
<div id="saving-grattan-charts" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Saving Grattan charts</h3>
<p>The <code>grattan_save</code> function saves your charts according to Grattan templates. It takes these arguments:</p>
<ul>
<li><code>filename</code>: the path, name and file-type of your saved chart. eg: <code>"atlas/population_chart.pdf"</code>.</li>
<li><code>object</code>: the R object that you want to save. eg: <code>pop_chart</code>. If left blank, it grabs the last chart that was displayed.</li>
<li><code>type</code>: the Grattan template to be used. This is one of:
<ul>
<li><code>"normal"</code> The default. Use for normal Grattan report charts, or to paste into a 4:3 Powerpoint slide. Width: 22.2cm, height: 14.5cm.</li>
<li><code>"normal_169"</code> Only useful for pasting into a 16:9 format Grattan Powerpoint slide. Width: 30cm, height: 14.5cm.</li>
<li><code>"tiny"</code> Fills the width of a column in a Grattan report, but is shorter than usual. Width: 22.2cm, height: 11.1cm.</li>
<li><code>"wholecolumn"</code> Takes up a whole column in a Grattan report. Width: 22.2cm, height: 22.2cm.</li>
<li><code>"fullpage"</code> Fills a whole page of a Grattan report. Width: 44.3cm, height: 22.2cm.</li>
<li><code>"fullslide"</code> Creates an image that looks like a 4:3 Grattan Powerpoint slide, complete with logo. Width: 25.4cm, height: 19.0cm.</li>
<li><code>"fullslide_169"</code> Creates` an image that looks like a 16:9 Grattan Powerpoint slide, complete with logo. Use this to drop into standard presentations. Width: 33.9cm, height: 19.0cm</li>
<li><code>"blog"</code> Creates a 4:3 image that looks like a Grattan Powerpoint slide, but with less border whitespace than ‘fullslide’."</li>
<li><code>"fullslide_44" Creates</code> an image that looks like a 4:4 Grattan Powerpoint slide. This may be useful for taller charts for the Grattan blog; not useful for any other purpose. Width: 25.4cm, height: 25.4cm.</li>
<li>Set <code>type = "all"</code> to save your chart in all available sizes.</li>
</ul></li>
<li><code>height</code>: override the height set by <code>type</code>. This can be useful for really long charts in blogposts.</li>
<li><code>save_data</code>: exports a <code>csv</code> file containing the data used in the chart.</li>
<li><code>force_labs</code>: override the removal of labels for a particular <code>type</code>. eg <code>force_labs = TRUE</code> will keep the y-axis label.</li>
</ul>
<p>To save the <code>pop_chart</code> plot created above as a whole-column chart for a <strong>report</strong>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="data-visualisation.html#cb20-1"></a><span class="kw">grattan_save</span>(<span class="st">&quot;atlas/population_chart_report.pdf&quot;</span>, pop_chart, <span class="dt">type =</span> <span class="st">&quot;wholecolumn&quot;</span>)</span></code></pre></div>
<!--- background: include=FALSE, echo=FALSE, results=FALSE ---->
<p><img src="atlas/population_chart_report.png" width="1396" /></p>
<p>To save it as a <strong>presentation</strong> slide instead, use <code>type = "fullslide"</code>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="data-visualisation.html#cb21-1"></a><span class="kw">grattan_save</span>(<span class="st">&quot;atlas/population_chart_presentation.pdf&quot;</span>, pop_chart, <span class="dt">type =</span> <span class="st">&quot;fullslide&quot;</span>)</span></code></pre></div>
<!--- background: include=FALSE, echo=FALSE, results=FALSE ---->
<p><img src="atlas/population_chart_presentation.png" width="1600" /></p>
<p>Or, if you want to emphasise the point in a <em>really tall</em> chart for a <strong>blogpost</strong>, you can use <code>type = "blog"</code> and adjust the <code>height</code> to be 50cm. Also note that because this is for the blog, you should save it as a <code>png</code> file:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="data-visualisation.html#cb22-1"></a><span class="kw">grattan_save</span>(<span class="st">&quot;atlas/population_chart_blog.png&quot;</span>, pop_chart, </span>
<span id="cb22-2"><a href="data-visualisation.html#cb22-2"></a>             <span class="dt">type =</span> <span class="st">&quot;blog&quot;</span>, <span class="dt">height =</span> <span class="dv">50</span>)</span></code></pre></div>
<!--- background: include=FALSE, echo=FALSE, results=FALSE ---->
<p><img src="atlas/population_chart_blog.png" width="1600" /></p>
<p>And that’s it! The following sections will go into more detail about different chart types in R, but you’ll mostly use the same basic <code>grattantheme</code> formatting you’ve used here.</p>
</div>
</div>
<div id="chart-cookbook" class="section level2">
<h2><span class="header-section-number">5.4</span> Chart cookbook</h2>
<p>This section takes you through a few often-used chart types.</p>
<div id="bar-charts" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Bar charts</h3>
<p>Bar charts are made with <code>geom_bar</code> or <code>geom_col</code>. Creating a bar chart will look something like this:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="data-visualisation.html#cb23-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>data<span class="op">&gt;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb23-2"><a href="data-visualisation.html#cb23-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="op">&lt;</span>xvar<span class="op">&gt;</span>, <span class="dt">y =</span> <span class="op">&lt;</span>yvar<span class="op">&gt;</span>),</span>
<span id="cb23-3"><a href="data-visualisation.html#cb23-3"></a>     <span class="dt">stat =</span> <span class="op">&lt;</span>STAT<span class="op">&gt;</span>, </span>
<span id="cb23-4"><a href="data-visualisation.html#cb23-4"></a>     <span class="dt">position =</span> <span class="op">&lt;</span>POSITION<span class="op">&gt;</span></span>
<span id="cb23-5"><a href="data-visualisation.html#cb23-5"></a><span class="st">  </span>)</span></code></pre></div>
<p>It has two key arguments: <code>stat</code> and <code>position</code>.</p>
<p>First, <code>stat</code> defines what kind of <em>operation</em> the function will do on the dataset before plotting. Some options are:</p>
<ul>
<li><code>"count"</code>, the default: count the number of observations in a particular group, and plot that number. This is useful when you’re using microdata. When this is the case, there is no need for a <code>y</code> aesthetic.</li>
<li><code>"sum"</code>: sum the values of the <code>y</code> aesthetic.</li>
<li><code>"identity"</code>: directly report the values of the <code>y</code> aesthetic. This is how Powerpoint and Excel charts work.</li>
</ul>
<p>You can use <code>geom_col</code> instead, as a shortcut for <code>geom_bar(stat = "identity)</code>.</p>
<p>Second, <code>position</code>, dictates how multiple bars occupying the same x-axis position will positioned. The options are:</p>
<ul>
<li><code>"stack"</code>, the default: bars in the same group are stacked atop one another.</li>
<li><code>"dodge"</code>: bars in the same group are positioned next to one another.</li>
<li><code>"fill"</code>: bars in the same group are stacked and all fill to 100 per cent.</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="data-visualisation.html#cb24-1"></a>population_table <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-2"><a href="data-visualisation.html#cb24-2"></a><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> state,</span>
<span id="cb24-3"><a href="data-visualisation.html#cb24-3"></a>                   <span class="dt">y =</span> pop,</span>
<span id="cb24-4"><a href="data-visualisation.html#cb24-4"></a>                   <span class="dt">fill =</span> year)) <span class="op">+</span></span>
<span id="cb24-5"><a href="data-visualisation.html#cb24-5"></a><span class="st">        </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb24-6"><a href="data-visualisation.html#cb24-6"></a>                 <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></span>
<span id="cb24-7"><a href="data-visualisation.html#cb24-7"></a><span class="st">        </span><span class="kw">theme_grattan</span>() <span class="op">+</span></span>
<span id="cb24-8"><a href="data-visualisation.html#cb24-8"></a><span class="st">        </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> comma) <span class="op">+</span></span>
<span id="cb24-9"><a href="data-visualisation.html#cb24-9"></a><span class="st">        </span><span class="kw">grattan_fill_manual</span>(<span class="dv">6</span>)</span></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/bar2-1.png" width="672" /></p>
<p>You can also <strong>order</strong> the groups in your chart by a variable. If you want to order states by population, use <code>reorder</code> inside <code>aes</code>:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="data-visualisation.html#cb25-1"></a>population_table <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-2"><a href="data-visualisation.html#cb25-2"></a><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(state, <span class="op">-</span>pop), <span class="co"># reorder state by negative population</span></span>
<span id="cb25-3"><a href="data-visualisation.html#cb25-3"></a>                   <span class="dt">y =</span> pop,</span>
<span id="cb25-4"><a href="data-visualisation.html#cb25-4"></a>                   <span class="dt">fill =</span> year)) <span class="op">+</span></span>
<span id="cb25-5"><a href="data-visualisation.html#cb25-5"></a><span class="st">        </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb25-6"><a href="data-visualisation.html#cb25-6"></a>                 <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></span>
<span id="cb25-7"><a href="data-visualisation.html#cb25-7"></a><span class="st">        </span><span class="kw">theme_grattan</span>() <span class="op">+</span></span>
<span id="cb25-8"><a href="data-visualisation.html#cb25-8"></a><span class="st">        </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> comma) <span class="op">+</span></span>
<span id="cb25-9"><a href="data-visualisation.html#cb25-9"></a><span class="st">        </span><span class="kw">grattan_fill_manual</span>(<span class="dv">6</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb25-10"><a href="data-visualisation.html#cb25-10"></a><span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/bar3-1.png" width="672" /></p>
<p>To flip the chart – a useful move when you have long labels – add <code>coord_flipped</code> (ie ‘flip coordinates’) and tell <code>theme_grattan</code> that the plot is flipped using <code>flipped = TRUE</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="data-visualisation.html#cb26-1"></a>population_table <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-2"><a href="data-visualisation.html#cb26-2"></a><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(state, <span class="op">-</span>pop), </span>
<span id="cb26-3"><a href="data-visualisation.html#cb26-3"></a>                   <span class="dt">y =</span> pop,</span>
<span id="cb26-4"><a href="data-visualisation.html#cb26-4"></a>                   <span class="dt">fill =</span> year)) <span class="op">+</span></span>
<span id="cb26-5"><a href="data-visualisation.html#cb26-5"></a><span class="st">        </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb26-6"><a href="data-visualisation.html#cb26-6"></a>                 <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></span>
<span id="cb26-7"><a href="data-visualisation.html#cb26-7"></a><span class="st">        </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st">  </span><span class="co"># flip the coordinates</span></span>
<span id="cb26-8"><a href="data-visualisation.html#cb26-8"></a><span class="st">        </span><span class="kw">theme_grattan</span>(<span class="dt">flipped =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st">  </span><span class="co"># tell theme_grattan</span></span>
<span id="cb26-9"><a href="data-visualisation.html#cb26-9"></a><span class="st">        </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> comma) <span class="op">+</span></span>
<span id="cb26-10"><a href="data-visualisation.html#cb26-10"></a><span class="st">        </span><span class="kw">grattan_fill_manual</span>(<span class="dv">6</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb26-11"><a href="data-visualisation.html#cb26-11"></a><span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/bar4-1.png" width="672" /></p>
</div>
<div id="line-charts" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Line charts</h3>
<p>A line chart has one key aesthetic: <code>group</code>. This tells <code>ggplot</code> how to connect individual lines.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="data-visualisation.html#cb27-1"></a>population_table <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb27-2"><a href="data-visualisation.html#cb27-2"></a><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year,</span>
<span id="cb27-3"><a href="data-visualisation.html#cb27-3"></a>                   <span class="dt">y =</span> pop,</span>
<span id="cb27-4"><a href="data-visualisation.html#cb27-4"></a>                   <span class="dt">colour =</span> state,</span>
<span id="cb27-5"><a href="data-visualisation.html#cb27-5"></a>                   <span class="dt">group =</span> state)) <span class="op">+</span></span>
<span id="cb27-6"><a href="data-visualisation.html#cb27-6"></a><span class="st">        </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb27-7"><a href="data-visualisation.html#cb27-7"></a><span class="st">        </span><span class="kw">theme_grattan</span>() <span class="op">+</span></span>
<span id="cb27-8"><a href="data-visualisation.html#cb27-8"></a><span class="st">        </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> comma) <span class="op">+</span></span>
<span id="cb27-9"><a href="data-visualisation.html#cb27-9"></a><span class="st">        </span><span class="kw">grattan_colour_manual</span>(<span class="dv">9</span>) <span class="op">+</span></span>
<span id="cb27-10"><a href="data-visualisation.html#cb27-10"></a><span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in grattantheme::grattan_pal(n = n, reverse = reverse, faded =
## faded): Using more than six colours is not recommended.</code></pre>
<p><img src="Data_visualisation_files/figure-html/line1-1.png" width="672" /></p>
<p>You can also add dots for each year by layering <code>geom_point</code> on top of <code>geom_line</code>:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="data-visualisation.html#cb29-1"></a>population_table <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-2"><a href="data-visualisation.html#cb29-2"></a><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year,</span>
<span id="cb29-3"><a href="data-visualisation.html#cb29-3"></a>                   <span class="dt">y =</span> pop,</span>
<span id="cb29-4"><a href="data-visualisation.html#cb29-4"></a>                   <span class="dt">colour =</span> state,</span>
<span id="cb29-5"><a href="data-visualisation.html#cb29-5"></a>                   <span class="dt">group =</span> state)) <span class="op">+</span></span>
<span id="cb29-6"><a href="data-visualisation.html#cb29-6"></a><span class="st">        </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb29-7"><a href="data-visualisation.html#cb29-7"></a><span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb29-8"><a href="data-visualisation.html#cb29-8"></a><span class="st">        </span><span class="kw">theme_grattan</span>() <span class="op">+</span></span>
<span id="cb29-9"><a href="data-visualisation.html#cb29-9"></a><span class="st">        </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> comma) <span class="op">+</span></span>
<span id="cb29-10"><a href="data-visualisation.html#cb29-10"></a><span class="st">        </span><span class="kw">grattan_colour_manual</span>(<span class="dv">9</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb29-11"><a href="data-visualisation.html#cb29-11"></a><span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in grattantheme::grattan_pal(n = n, reverse = reverse, faded =
## faded): Using more than six colours is not recommended.</code></pre>
<p><img src="Data_visualisation_files/figure-html/line2-1.png" width="672" /></p>
<p>If you wanted to show each state individually, you could <strong>facet</strong> your chart so that a separate plot was produced for each state:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="data-visualisation.html#cb31-1"></a>population_table <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb31-2"><a href="data-visualisation.html#cb31-2"></a><span class="st">        </span><span class="kw">filter</span>(state <span class="op">!=</span><span class="st"> &quot;ACT&quot;</span>,</span>
<span id="cb31-3"><a href="data-visualisation.html#cb31-3"></a>               state <span class="op">!=</span><span class="st"> &quot;NT&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb31-4"><a href="data-visualisation.html#cb31-4"></a><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year,</span>
<span id="cb31-5"><a href="data-visualisation.html#cb31-5"></a>                   <span class="dt">y =</span> pop,</span>
<span id="cb31-6"><a href="data-visualisation.html#cb31-6"></a>                   <span class="dt">group =</span> state)) <span class="op">+</span></span>
<span id="cb31-7"><a href="data-visualisation.html#cb31-7"></a><span class="st">        </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb31-8"><a href="data-visualisation.html#cb31-8"></a><span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb31-9"><a href="data-visualisation.html#cb31-9"></a><span class="st">        </span><span class="kw">theme_grattan</span>() <span class="op">+</span></span>
<span id="cb31-10"><a href="data-visualisation.html#cb31-10"></a><span class="st">        </span><span class="kw">grattan_y_continuous</span>() <span class="op">+</span></span>
<span id="cb31-11"><a href="data-visualisation.html#cb31-11"></a><span class="st">        </span><span class="kw">facet_wrap</span>(state <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span><span class="st"> </span></span>
<span id="cb31-12"><a href="data-visualisation.html#cb31-12"></a><span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/line3-1.png" width="672" /></p>
<p>To tidy this up, we can:</p>
<ol style="list-style-type: decimal">
<li>shorten the years to be “13”, “14”, etc instead of “2013”, “2014”, etc (via the <code>x</code> aesthetic)</li>
<li>shorten the y-axis labels to “millions” (via the <code>y</code> aesthetic)</li>
<li>add a black horizontal line at the bottom of each facet</li>
<li>give the facets a bit of room by adjusting <code>panel.spacing</code></li>
<li>define our own x-axis label breaks to just show <code>13</code>, <code>15</code> and <code>17</code></li>
</ol>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="data-visualisation.html#cb32-1"></a>population_table <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-2"><a href="data-visualisation.html#cb32-2"></a><span class="st">        </span><span class="kw">filter</span>(state <span class="op">!=</span><span class="st"> &quot;ACT&quot;</span>,</span>
<span id="cb32-3"><a href="data-visualisation.html#cb32-3"></a>               state <span class="op">!=</span><span class="st"> &quot;NT&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-4"><a href="data-visualisation.html#cb32-4"></a><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">substr</span>(year, <span class="dv">3</span>, <span class="dv">4</span>), <span class="co"># 1: just take the last two characters</span></span>
<span id="cb32-5"><a href="data-visualisation.html#cb32-5"></a>                   <span class="dt">y =</span> pop <span class="op">/</span><span class="st"> </span><span class="fl">1e6</span>, <span class="co"># 2: divide population by one million</span></span>
<span id="cb32-6"><a href="data-visualisation.html#cb32-6"></a>                   <span class="dt">group =</span> state)) <span class="op">+</span></span>
<span id="cb32-7"><a href="data-visualisation.html#cb32-7"></a><span class="st">        </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb32-8"><a href="data-visualisation.html#cb32-8"></a><span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb32-9"><a href="data-visualisation.html#cb32-9"></a><span class="st">        </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="co"># 3: add horizontal line at the bottom</span></span>
<span id="cb32-10"><a href="data-visualisation.html#cb32-10"></a><span class="st">        </span><span class="kw">theme_grattan</span>() <span class="op">+</span></span>
<span id="cb32-11"><a href="data-visualisation.html#cb32-11"></a><span class="st">        </span><span class="kw">theme</span>(<span class="dt">panel.spacing =</span> <span class="kw">unit</span>(<span class="dv">10</span>, <span class="st">&quot;mm&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># 4: add panel spacing</span></span>
<span id="cb32-12"><a href="data-visualisation.html#cb32-12"></a><span class="st">        </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> comma) <span class="op">+</span></span>
<span id="cb32-13"><a href="data-visualisation.html#cb32-13"></a><span class="st">        </span><span class="kw">scale_x_discrete</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;13&quot;</span>, <span class="st">&quot;15&quot;</span>, <span class="st">&quot;17&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># 5: define our own label breaks</span></span>
<span id="cb32-14"><a href="data-visualisation.html#cb32-14"></a><span class="st">        </span><span class="kw">facet_wrap</span>(state <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span><span class="st"> </span></span>
<span id="cb32-15"><a href="data-visualisation.html#cb32-15"></a><span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/line4-1.png" width="672" /></p>
</div>
<div id="scatter-plots" class="section level3">
<h3><span class="header-section-number">5.4.3</span> Scatter plots</h3>
<p>Scatter plots require <code>x</code> and <code>y</code> aesthetics. These can then be coloured and facetted.</p>
<p>First, create a dataset that we’ll use for scatter plots. Take the <code>population_table</code> dataset and transform it to have one variable for population in 2013, and another for population in 2018:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="data-visualisation.html#cb33-1"></a>population_diff &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/population_sa4.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-2"><a href="data-visualisation.html#cb33-2"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">state_long =</span> state,</span>
<span id="cb33-3"><a href="data-visualisation.html#cb33-3"></a>               <span class="dt">state =</span> strayr<span class="op">::</span><span class="kw">strayr</span>(state_long),</span>
<span id="cb33-4"><a href="data-visualisation.html#cb33-4"></a>               <span class="dt">pop =</span> <span class="kw">as.numeric</span>(value),</span>
<span id="cb33-5"><a href="data-visualisation.html#cb33-5"></a>               <span class="dt">year =</span> <span class="kw">as.factor</span>(glue<span class="op">::</span><span class="kw">glue</span>(<span class="st">&quot;y{year}&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-6"><a href="data-visualisation.html#cb33-6"></a><span class="st">        </span><span class="kw">filter</span>(year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;y2013&quot;</span>, <span class="st">&quot;y2018&quot;</span>),</span>
<span id="cb33-7"><a href="data-visualisation.html#cb33-7"></a>               data_item <span class="op">==</span><span class="st"> &quot;Persons - Total (no.)&quot;</span>,</span>
<span id="cb33-8"><a href="data-visualisation.html#cb33-8"></a>               sa4_name <span class="op">!=</span><span class="st"> &quot;Other Territories&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-9"><a href="data-visualisation.html#cb33-9"></a><span class="st">        </span><span class="kw">group_by</span>(year, state, sa4_name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-10"><a href="data-visualisation.html#cb33-10"></a><span class="st">        </span><span class="kw">summarise</span>(<span class="dt">pop =</span> <span class="kw">sum</span>(pop)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-11"><a href="data-visualisation.html#cb33-11"></a><span class="st">        </span><span class="kw">spread</span>(year, pop) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-12"><a href="data-visualisation.html#cb33-12"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">pop_change =</span> <span class="dv">100</span> <span class="op">*</span><span class="st"> </span>(y2018 <span class="op">/</span><span class="st"> </span>y2013 <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="data-visualisation.html#cb34-1"></a>population_diff <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb34-2"><a href="data-visualisation.html#cb34-2"></a><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y2013<span class="op">/</span><span class="dv">1000</span>,</span>
<span id="cb34-3"><a href="data-visualisation.html#cb34-3"></a>                   <span class="dt">y =</span> pop_change)) <span class="op">+</span></span>
<span id="cb34-4"><a href="data-visualisation.html#cb34-4"></a><span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-5"><a href="data-visualisation.html#cb34-5"></a><span class="st">        </span><span class="kw">theme_grattan</span>() <span class="op">+</span></span>
<span id="cb34-6"><a href="data-visualisation.html#cb34-6"></a><span class="st">        </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span></span>
<span id="cb34-7"><a href="data-visualisation.html#cb34-7"></a><span class="st">        </span><span class="kw">grattan_y_continuous</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-8"><a href="data-visualisation.html#cb34-8"></a><span class="st">        </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Population increase to 2018, per cent&quot;</span>,</span>
<span id="cb34-9"><a href="data-visualisation.html#cb34-9"></a>             <span class="dt">x =</span> <span class="st">&quot;Population in 2013, thousands&quot;</span>)</span></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/scatter1-1.png" width="672" /></p>
<p>It looks like the areas with the largest population grew the most between 2013 and 2018. To explore the relationship further, you can add a line-of-best-fit with <code>geom_smooth</code>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="data-visualisation.html#cb35-1"></a>population_diff <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-2"><a href="data-visualisation.html#cb35-2"></a><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y2013<span class="op">/</span><span class="dv">1000</span>,  <span class="co"># display the x-axis as thousands</span></span>
<span id="cb35-3"><a href="data-visualisation.html#cb35-3"></a>                   <span class="dt">y =</span> pop_change)) <span class="op">+</span></span>
<span id="cb35-4"><a href="data-visualisation.html#cb35-4"></a><span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb35-5"><a href="data-visualisation.html#cb35-5"></a><span class="st">        </span><span class="kw">geom_smooth</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb35-6"><a href="data-visualisation.html#cb35-6"></a><span class="st">        </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></span>
<span id="cb35-7"><a href="data-visualisation.html#cb35-7"></a><span class="st">        </span><span class="kw">theme_grattan</span>() <span class="op">+</span></span>
<span id="cb35-8"><a href="data-visualisation.html#cb35-8"></a><span class="st">        </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span></span>
<span id="cb35-9"><a href="data-visualisation.html#cb35-9"></a><span class="st">        </span><span class="kw">grattan_y_continuous</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb35-10"><a href="data-visualisation.html#cb35-10"></a><span class="st">        </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Population increase to 2018, per cent&quot;</span>,</span>
<span id="cb35-11"><a href="data-visualisation.html#cb35-11"></a>             <span class="dt">x =</span> <span class="st">&quot;Population in 2013, thousands&quot;</span>)</span></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/scatter2-1.png" width="672" /></p>
<p>You could colour-code positive and negative changes from within the <code>geom_point</code> aesthetic. Making a change there won’t pass through to the <code>geom_smooth</code> aesthetic, so your line-of-best-fit will apply to all data points.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="data-visualisation.html#cb36-1"></a>population_diff <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-2"><a href="data-visualisation.html#cb36-2"></a><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y2013<span class="op">/</span><span class="dv">1000</span>,  <span class="co"># display the x-axis as thousands</span></span>
<span id="cb36-3"><a href="data-visualisation.html#cb36-3"></a>                   <span class="dt">y =</span> pop_change)) <span class="op">+</span></span>
<span id="cb36-4"><a href="data-visualisation.html#cb36-4"></a><span class="st">        </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> pop_change <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>),</span>
<span id="cb36-5"><a href="data-visualisation.html#cb36-5"></a>                   <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb36-6"><a href="data-visualisation.html#cb36-6"></a><span class="st">        </span><span class="kw">geom_smooth</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb36-7"><a href="data-visualisation.html#cb36-7"></a><span class="st">        </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></span>
<span id="cb36-8"><a href="data-visualisation.html#cb36-8"></a><span class="st">        </span><span class="kw">theme_grattan</span>() <span class="op">+</span></span>
<span id="cb36-9"><a href="data-visualisation.html#cb36-9"></a><span class="st">        </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span></span>
<span id="cb36-10"><a href="data-visualisation.html#cb36-10"></a><span class="st">        </span><span class="kw">grattan_y_continuous</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb36-11"><a href="data-visualisation.html#cb36-11"></a><span class="st">        </span><span class="kw">grattan_colour_manual</span>(<span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb36-12"><a href="data-visualisation.html#cb36-12"></a><span class="st">        </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Population increase to 2018, per cent&quot;</span>,</span>
<span id="cb36-13"><a href="data-visualisation.html#cb36-13"></a>             <span class="dt">x =</span> <span class="st">&quot;Population in 2013, thousands&quot;</span>)</span></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/scatter3-1.png" width="672" /></p>
<p>Like the charts above, you could facet this by state to see if there were any interesting patterns. We’ll filter out ACT and NT because they only have one and two data points (SA4s) in them, respectively.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="data-visualisation.html#cb37-1"></a>population_diff <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-2"><a href="data-visualisation.html#cb37-2"></a><span class="st">        </span><span class="kw">filter</span>(state <span class="op">!=</span><span class="st"> &quot;ACT&quot;</span>,</span>
<span id="cb37-3"><a href="data-visualisation.html#cb37-3"></a>               state <span class="op">!=</span><span class="st"> &quot;NT&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-4"><a href="data-visualisation.html#cb37-4"></a><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y2013<span class="op">/</span><span class="dv">1000</span>,  <span class="co"># display the x-axis as thousands</span></span>
<span id="cb37-5"><a href="data-visualisation.html#cb37-5"></a>                   <span class="dt">y =</span> pop_change)) <span class="op">+</span></span>
<span id="cb37-6"><a href="data-visualisation.html#cb37-6"></a><span class="st">        </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> pop_change <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>),</span>
<span id="cb37-7"><a href="data-visualisation.html#cb37-7"></a>                   <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb37-8"><a href="data-visualisation.html#cb37-8"></a><span class="st">        </span><span class="kw">geom_smooth</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb37-9"><a href="data-visualisation.html#cb37-9"></a><span class="st">        </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></span>
<span id="cb37-10"><a href="data-visualisation.html#cb37-10"></a><span class="st">        </span><span class="kw">theme_grattan</span>() <span class="op">+</span></span>
<span id="cb37-11"><a href="data-visualisation.html#cb37-11"></a><span class="st">        </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span></span>
<span id="cb37-12"><a href="data-visualisation.html#cb37-12"></a><span class="st">        </span><span class="kw">grattan_y_continuous</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb37-13"><a href="data-visualisation.html#cb37-13"></a><span class="st">        </span><span class="kw">grattan_colour_manual</span>(<span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb37-14"><a href="data-visualisation.html#cb37-14"></a><span class="st">        </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Population increase to 2018, per cent&quot;</span>,</span>
<span id="cb37-15"><a href="data-visualisation.html#cb37-15"></a>             <span class="dt">x =</span> <span class="st">&quot;Population in 2013, thousands&quot;</span>) <span class="op">+</span></span>
<span id="cb37-16"><a href="data-visualisation.html#cb37-16"></a><span class="st">        </span><span class="kw">facet_wrap</span>(state <span class="op">~</span><span class="st"> </span>.)</span></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/scatter4-1.png" width="672" /></p>
</div>
<div id="distributions" class="section level3">
<h3><span class="header-section-number">5.4.4</span> Distributions</h3>
<p><code>geom_histogram</code>
<code>geom_density</code></p>
<p><code>ggridges::</code></p>
</div>
<div id="maps" class="section level3">
<h3><span class="header-section-number">5.4.5</span> Maps</h3>
<div id="sf-objects" class="section level4">
<h4><span class="header-section-number">5.4.5.1</span> <code>sf</code> objects</h4>
<p>[what is]</p>
</div>
<div id="using-absmapsdata" class="section level4">
<h4><span class="header-section-number">5.4.5.2</span> Using <code>absmapsdata</code></h4>
<p>The <code>absmapsdata</code> contains compressed, and tidied <code>sf</code> objects containing geometric information about ABS data structures. The included objects are:</p>
<ul>
<li>Statistical Area 1 2011: <code>sa12011</code></li>
<li>Statistical Area 1 2016: <code>sa12016</code></li>
<li>Statistical Area 2 2011: <code>sa22011</code></li>
<li>Statistical Area 2 2016: <code>sa22016</code></li>
<li>Statistical Area 3 2011: <code>sa32011</code></li>
<li>Statistical Area 3 2016: <code>sa32016</code></li>
<li>Statistical Area 4 2011: <code>sa42011</code></li>
<li>Statistical Area 4 2016: <code>sa42016</code></li>
<li>Greater Capital Cities 2011: <code>gcc2011</code></li>
<li>Greater Capital Cities 2016: <code>gcc2016</code></li>
<li>Remoteness Areas 2011: <code>ra2011</code></li>
<li>Remoteness Areas 2016: <code>ra2016</code></li>
<li>State 2011: <code>state2011</code></li>
<li>State 2016: <code>state2016</code></li>
<li>Commonwealth Electoral Divisions 2018: <code>ced2018</code></li>
<li>State Electoral Divisions 2018:<code>sed2018</code></li>
<li>Local Government Areas 2016: <code>lga2016</code></li>
<li>Local Government Areas 2018: <code>lga2018</code></li>
</ul>
<p>You can install the package from Github. You will also need the <code>sf</code> package installed to handle the <code>sf</code> objects.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="data-visualisation.html#cb38-1"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;wfmackey/absmapsdata&quot;</span>)</span>
<span id="cb38-2"><a href="data-visualisation.html#cb38-2"></a><span class="kw">library</span>(absmapsdata)</span>
<span id="cb38-3"><a href="data-visualisation.html#cb38-3"></a></span>
<span id="cb38-4"><a href="data-visualisation.html#cb38-4"></a><span class="kw">install.packages</span>(<span class="st">&quot;sf&quot;</span>)</span>
<span id="cb38-5"><a href="data-visualisation.html#cb38-5"></a><span class="kw">library</span>(sf)</span></code></pre></div>
</div>
<div id="making-choropleth-maps" class="section level4">
<h4><span class="header-section-number">5.4.5.3</span> Making choropleth maps</h4>
<p>Choropleth maps break an area into ‘bits’, and colours each ‘bit’ according to a variable.</p>
<p>SA4 is the largest non-state statistical area in the ABS ASGS standard.</p>
<p>You can join the <code>sf</code> objects from <code>absmapsdata</code> to your dataset using <code>left_join</code>. The variable names might be different – eg <code>sa4_name</code> compared to <code>sa4_name_2016</code> – so use the <code>by</code> function to match them.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="data-visualisation.html#cb39-1"></a>map_data &lt;-<span class="st"> </span>population_diff <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-2"><a href="data-visualisation.html#cb39-2"></a><span class="st">        </span><span class="kw">left_join</span>(sa42016, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;sa4_name&quot;</span> =<span class="st"> &quot;sa4_name_2016&quot;</span>))</span>
<span id="cb39-3"><a href="data-visualisation.html#cb39-3"></a></span>
<span id="cb39-4"><a href="data-visualisation.html#cb39-4"></a><span class="kw">head</span>(map_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-5"><a href="data-visualisation.html#cb39-5"></a><span class="st">       </span><span class="kw">select</span>(sa4_name, geometry))</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
## # Groups:   state [2]
##   state sa4_name                                                   geometry
##   &lt;chr&gt; &lt;chr&gt;                                            &lt;MULTIPOLYGON [°]&gt;
## 1 ACT   Australian Capita… (((148.8041 -35.71402, 148.8018 -35.7121, 148.7…
## 2 NSW   Capital Region     (((150.3113 -35.66588, 150.3126 -35.66814, 150.…
## 3 NSW   Central Coast      (((151.315 -33.55582, 151.3159 -33.55503, 151.3…
## 4 NSW   Central West       (((150.6107 -33.06614, 150.6117 -33.07051, 150.…
## 5 NSW   Coffs Harbour - G… (((153.2785 -29.91874, 153.2773 -29.92067, 153.…
## 6 NSW   Far West and Orana (((150.1106 -31.74613, 150.1103 -31.74892, 150.…</code></pre>
<p>You then plot a map like you would any other <code>ggplot</code>: provide your data, choose your <code>aes</code> and your <code>geom</code>. For maps with <code>sf</code> objects, the key <strong>aesthetic</strong> is <code>geometry = geometry</code>, and the <strong>geom</strong> is <code>geom_sf</code>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="data-visualisation.html#cb41-1"></a>map &lt;-<span class="st"> </span>map_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-2"><a href="data-visualisation.html#cb41-2"></a><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">geometry =</span> geometry,</span>
<span id="cb41-3"><a href="data-visualisation.html#cb41-3"></a>                   <span class="dt">fill =</span> pop_change)) <span class="op">+</span></span>
<span id="cb41-4"><a href="data-visualisation.html#cb41-4"></a><span class="st">        </span><span class="kw">geom_sf</span>(<span class="dt">lwd =</span> <span class="dv">0</span>) <span class="op">+</span></span>
<span id="cb41-5"><a href="data-visualisation.html#cb41-5"></a><span class="st">        </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb41-6"><a href="data-visualisation.html#cb41-6"></a><span class="st">        </span><span class="kw">grattan_fill_manual</span>(<span class="dt">discrete =</span> <span class="ot">FALSE</span>, </span>
<span id="cb41-7"><a href="data-visualisation.html#cb41-7"></a>                            <span class="dt">palette =</span> <span class="st">&quot;diverging&quot;</span>,</span>
<span id="cb41-8"><a href="data-visualisation.html#cb41-8"></a>                            <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>, <span class="dv">20</span>),</span>
<span id="cb41-9"><a href="data-visualisation.html#cb41-9"></a>                            <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb41-10"><a href="data-visualisation.html#cb41-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;Population change&quot;</span>)</span>
<span id="cb41-11"><a href="data-visualisation.html#cb41-11"></a></span>
<span id="cb41-12"><a href="data-visualisation.html#cb41-12"></a>map</span></code></pre></div>
<p><img src="Data_visualisation_files/figure-html/map1-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="creating-simple-interactive-graphs-with-plotly" class="section level2">
<h2><span class="header-section-number">5.5</span> Creating simple interactive graphs with <code>plotly</code></h2>
<p><code>plotly::ggplotly()</code></p>
</div>
<div id="bin-generate-data-used-before-prior-sections-are-constructed" class="section level2">
<h2><span class="header-section-number">5.6</span> bin: generate data used (before prior sections are constructed)</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="data-visualisation.html#cb42-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb42-2"><a href="data-visualisation.html#cb42-2"></a><span class="kw">library</span>(janitor)</span>
<span id="cb42-3"><a href="data-visualisation.html#cb42-3"></a><span class="kw">library</span>(absmapsdata)</span>
<span id="cb42-4"><a href="data-visualisation.html#cb42-4"></a></span>
<span id="cb42-5"><a href="data-visualisation.html#cb42-5"></a>data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/ABS_REGIONAL_ASGS2016_02082019164509969.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-6"><a href="data-visualisation.html#cb42-6"></a><span class="st">        </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-7"><a href="data-visualisation.html#cb42-7"></a><span class="st">        </span><span class="kw">select</span>(<span class="dt">data_code =</span> measure,</span>
<span id="cb42-8"><a href="data-visualisation.html#cb42-8"></a>               data_item,</span>
<span id="cb42-9"><a href="data-visualisation.html#cb42-9"></a>               <span class="dt">asgs =</span> regiontype,</span>
<span id="cb42-10"><a href="data-visualisation.html#cb42-10"></a>               <span class="dt">sa4_code_2016 =</span> asgs_<span class="dv">2016</span>,</span>
<span id="cb42-11"><a href="data-visualisation.html#cb42-11"></a>               <span class="dt">sa4_name_2016 =</span> region,</span>
<span id="cb42-12"><a href="data-visualisation.html#cb42-12"></a>               <span class="dt">year =</span> time,</span>
<span id="cb42-13"><a href="data-visualisation.html#cb42-13"></a>               value) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-14"><a href="data-visualisation.html#cb42-14"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">sa4_code_2016 =</span> <span class="kw">as.character</span>(sa4_code_<span class="dv">2016</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-15"><a href="data-visualisation.html#cb42-15"></a><span class="st">        </span><span class="kw">left_join</span>(sa42016 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(sa4_code_<span class="dv">2016</span>, state_name_<span class="dv">2016</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-16"><a href="data-visualisation.html#cb42-16"></a><span class="st">        </span><span class="kw">rename</span>(<span class="dt">state =</span> state_name_<span class="dv">2016</span>,</span>
<span id="cb42-17"><a href="data-visualisation.html#cb42-17"></a>               <span class="dt">sa4_code =</span> sa4_code_<span class="dv">2016</span>,</span>
<span id="cb42-18"><a href="data-visualisation.html#cb42-18"></a>               <span class="dt">sa4_name =</span> sa4_name_<span class="dv">2016</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-19"><a href="data-visualisation.html#cb42-19"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">state_long =</span> state,</span>
<span id="cb42-20"><a href="data-visualisation.html#cb42-20"></a>               <span class="dt">state =</span> strayr<span class="op">::</span><span class="kw">strayr</span>(state_long))</span>
<span id="cb42-21"><a href="data-visualisation.html#cb42-21"></a>               </span>
<span id="cb42-22"><a href="data-visualisation.html#cb42-22"></a><span class="kw">write_csv</span>(data, <span class="st">&quot;data/population_sa4.csv&quot;</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="organising-an-r-project-at-grttan.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reading-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["r-at-grattan.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
