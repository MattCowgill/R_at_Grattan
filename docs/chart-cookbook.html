<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Chart cookbook | Using R at Grattan Institute</title>
  <meta name="description" content="How to use R good. In development." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Chart cookbook | Using R at Grattan Institute" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="How to use R good. In development." />
  <meta name="github-repo" content="grattan/R_at_Grattan" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Chart cookbook | Using R at Grattan Institute" />
  
  <meta name="twitter:description" content="How to use R good. In development." />
  

<meta name="author" content="Will Mackey and Matt Cowgill" />


<meta name="date" content="2019-09-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-visualisation.html">
<link rel="next" href="reading-data.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Using R at Grattan Institute</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#what-is-r"><i class="fa fa-check"></i><b>1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#what-is-rstudio"><i class="fa fa-check"></i><b>1.2</b> What is RStudio?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>1.3</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#packages"><i class="fa fa-check"></i><b>1.4</b> Packages</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#installing-packages"><i class="fa fa-check"></i><b>1.4.1</b> Installing packages</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#using-packages"><i class="fa fa-check"></i><b>1.4.2</b> Using packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="why-use-r.html"><a href="why-use-r.html"><i class="fa fa-check"></i><b>2</b> Why use R?</a><ul>
<li class="chapter" data-level="2.1" data-path="why-use-r.html"><a href="why-use-r.html#why-script"><i class="fa fa-check"></i><b>2.1</b> Why use script-based software?</a></li>
<li class="chapter" data-level="2.2" data-path="why-use-r.html"><a href="why-use-r.html#why-R"><i class="fa fa-check"></i><b>2.2</b> Why use R specifically?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>3</b> Using R at Grattan</a><ul>
<li class="chapter" data-level="3.1" data-path="intro.html"><a href="intro.html#using-r-projects-for-a-fully-reproducible-workflow."><i class="fa fa-check"></i><b>3.1</b> Using R projects for a fully reproducible workflow.</a><ul>
<li class="chapter" data-level="3.1.1" data-path="intro.html"><a href="intro.html#filepaths"><i class="fa fa-check"></i><b>3.1.1</b> Filepaths</a></li>
<li class="chapter" data-level="3.1.2" data-path="intro.html"><a href="intro.html#keep-your-scripts-manageable"><i class="fa fa-check"></i><b>3.1.2</b> Keep your scripts manageable</a></li>
<li class="chapter" data-level="3.1.3" data-path="intro.html"><a href="intro.html#use-subfolders-of-your-project-folder"><i class="fa fa-check"></i><b>3.1.3</b> Use subfolders of your project folder</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="intro.html"><a href="intro.html#grattan-coding-style-guide"><i class="fa fa-check"></i><b>3.2</b> Grattan coding style guide</a></li>
<li class="chapter" data-level="3.3" data-path="intro.html"><a href="intro.html#what-is-the-tidyverse-and-why-do-we-use-it"><i class="fa fa-check"></i><b>3.3</b> What is the tidyverse and why do we use it?</a></li>
<li class="chapter" data-level="3.4" data-path="intro.html"><a href="intro.html#an-introduction-to-rmarkdown"><i class="fa fa-check"></i><b>3.4</b> An introduction to RMarkdown</a></li>
<li class="chapter" data-level="3.5" data-path="intro.html"><a href="intro.html#resources-in-this-package"><i class="fa fa-check"></i><b>3.5</b> Resources in this package</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-visualisation.html"><a href="data-visualisation.html"><i class="fa fa-check"></i><b>4</b> Data Visualisation</a><ul>
<li class="chapter" data-level="4.1" data-path="data-visualisation.html"><a href="data-visualisation.html#introduction-to-data-visualisation"><i class="fa fa-check"></i><b>4.1</b> Introduction to data visualisation</a></li>
<li class="chapter" data-level="4.2" data-path="data-visualisation.html"><a href="data-visualisation.html#set-up-and-packages"><i class="fa fa-check"></i><b>4.2</b> Set-up and packages</a></li>
<li class="chapter" data-level="4.3" data-path="data-visualisation.html"><a href="data-visualisation.html#concepts"><i class="fa fa-check"></i><b>4.3</b> Concepts</a></li>
<li class="chapter" data-level="4.4" data-path="data-visualisation.html"><a href="data-visualisation.html#exploratory-data-visualisation"><i class="fa fa-check"></i><b>4.4</b> Exploratory data visualisation</a></li>
<li class="chapter" data-level="4.5" data-path="data-visualisation.html"><a href="data-visualisation.html#making-grattan-y-charts"><i class="fa fa-check"></i><b>4.5</b> Making Grattan-y charts</a><ul>
<li class="chapter" data-level="4.5.1" data-path="data-visualisation.html"><a href="data-visualisation.html#making-grattan-charts"><i class="fa fa-check"></i><b>4.5.1</b> Making Grattan charts</a></li>
<li class="chapter" data-level="4.5.2" data-path="data-visualisation.html"><a href="data-visualisation.html#saving-grattan-charts"><i class="fa fa-check"></i><b>4.5.2</b> Saving Grattan charts</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-visualisation.html"><a href="data-visualisation.html#adding-labels"><i class="fa fa-check"></i><b>4.6</b> Adding labels</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chart-cookbook.html"><a href="chart-cookbook.html"><i class="fa fa-check"></i><b>5</b> Chart cookbook</a><ul>
<li class="chapter" data-level="5.1" data-path="chart-cookbook.html"><a href="chart-cookbook.html#set-up"><i class="fa fa-check"></i><b>5.1</b> Set up</a></li>
<li class="chapter" data-level="5.2" data-path="chart-cookbook.html"><a href="chart-cookbook.html#bar-charts"><i class="fa fa-check"></i><b>5.2</b> Bar charts</a><ul>
<li class="chapter" data-level="5.2.1" data-path="chart-cookbook.html"><a href="chart-cookbook.html#labelling-bar-charts"><i class="fa fa-check"></i><b>5.2.1</b> Labelling bar charts</a></li>
<li class="chapter" data-level="5.2.2" data-path="chart-cookbook.html"><a href="chart-cookbook.html#facet-bar"><i class="fa fa-check"></i><b>5.2.2</b> Facetting bar charts</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chart-cookbook.html"><a href="chart-cookbook.html#line-charts"><i class="fa fa-check"></i><b>5.3</b> Line charts</a></li>
<li class="chapter" data-level="5.4" data-path="chart-cookbook.html"><a href="chart-cookbook.html#scatter-plots"><i class="fa fa-check"></i><b>5.4</b> Scatter plots</a></li>
<li class="chapter" data-level="5.5" data-path="chart-cookbook.html"><a href="chart-cookbook.html#distributions"><i class="fa fa-check"></i><b>5.5</b> Distributions</a></li>
<li class="chapter" data-level="5.6" data-path="chart-cookbook.html"><a href="chart-cookbook.html#maps"><i class="fa fa-check"></i><b>5.6</b> Maps</a><ul>
<li class="chapter" data-level="5.6.1" data-path="chart-cookbook.html"><a href="chart-cookbook.html#sf-objects"><i class="fa fa-check"></i><b>5.6.1</b> <code>sf</code> objects</a></li>
<li class="chapter" data-level="5.6.2" data-path="chart-cookbook.html"><a href="chart-cookbook.html#using-absmapsdata"><i class="fa fa-check"></i><b>5.6.2</b> Using <code>absmapsdata</code></a></li>
<li class="chapter" data-level="5.6.3" data-path="chart-cookbook.html"><a href="chart-cookbook.html#making-choropleth-maps"><i class="fa fa-check"></i><b>5.6.3</b> Making choropleth maps</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="chart-cookbook.html"><a href="chart-cookbook.html#creating-simple-interactive-graphs-with-plotly"><i class="fa fa-check"></i><b>5.7</b> Creating simple interactive graphs with <code>plotly</code></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reading-data.html"><a href="reading-data.html"><i class="fa fa-check"></i><b>6</b> Reading data</a><ul>
<li class="chapter" data-level="6.1" data-path="reading-data.html"><a href="reading-data.html#importing-data"><i class="fa fa-check"></i><b>6.1</b> Importing data</a><ul>
<li class="chapter" data-level="6.1.1" data-path="reading-data.html"><a href="reading-data.html#reading-csv-files"><i class="fa fa-check"></i><b>6.1.1</b> Reading CSV files</a></li>
<li class="chapter" data-level="6.1.2" data-path="reading-data.html"><a href="reading-data.html#readxlread_excel"><i class="fa fa-check"></i><b>6.1.2</b> <code>readxl::read_excel()</code></a></li>
<li class="chapter" data-level="6.1.3" data-path="reading-data.html"><a href="reading-data.html#rio"><i class="fa fa-check"></i><b>6.1.3</b> <code>rio</code></a></li>
<li class="chapter" data-level="6.1.4" data-path="reading-data.html"><a href="reading-data.html#readabs"><i class="fa fa-check"></i><b>6.1.4</b> <code>readabs</code></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="reading-data.html"><a href="reading-data.html#reading-common-files"><i class="fa fa-check"></i><b>6.2</b> Reading common files:</a></li>
<li class="chapter" data-level="6.3" data-path="reading-data.html"><a href="reading-data.html#appropriately-renaming-variables"><i class="fa fa-check"></i><b>6.3</b> Appropriately renaming variables</a></li>
<li class="chapter" data-level="6.4" data-path="reading-data.html"><a href="reading-data.html#getting-to-tidy-data"><i class="fa fa-check"></i><b>6.4</b> Getting to tidy data</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="different-data-types.html"><a href="different-data-types.html"><i class="fa fa-check"></i><b>7</b> Different data types</a><ul>
<li class="chapter" data-level="7.1" data-path="different-data-types.html"><a href="different-data-types.html#tidy-data"><i class="fa fa-check"></i><b>7.1</b> Tidy data</a></li>
<li class="chapter" data-level="7.2" data-path="different-data-types.html"><a href="different-data-types.html#dates-with-lubridate"><i class="fa fa-check"></i><b>7.2</b> Dates with <code>lubridate::</code></a></li>
<li class="chapter" data-level="7.3" data-path="different-data-types.html"><a href="different-data-types.html#strings-with-stringr"><i class="fa fa-check"></i><b>7.3</b> Strings with <code>stringr::</code></a></li>
<li class="chapter" data-level="7.4" data-path="different-data-types.html"><a href="different-data-types.html#factors-with-forcats"><i class="fa fa-check"></i><b>7.4</b> Factors with <code>forcats::</code></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>8</b> Data transformation</a><ul>
<li class="chapter" data-level="8.1" data-path="data-transformation.html"><a href="data-transformation.html#the-pipe"><i class="fa fa-check"></i><b>8.1</b> The pipe</a></li>
<li class="chapter" data-level="8.2" data-path="data-transformation.html"><a href="data-transformation.html#key-dplyr-functions"><i class="fa fa-check"></i><b>8.2</b> Key <code>dplyr</code> functions:</a></li>
<li class="chapter" data-level="8.3" data-path="data-transformation.html"><a href="data-transformation.html#filter-with-filter"><i class="fa fa-check"></i><b>8.3</b> Filter with <code>filter()</code></a></li>
<li class="chapter" data-level="8.4" data-path="data-transformation.html"><a href="data-transformation.html#arrange-with-arrange"><i class="fa fa-check"></i><b>8.4</b> Arrange with <code>arrange()</code></a></li>
<li class="chapter" data-level="8.5" data-path="data-transformation.html"><a href="data-transformation.html#select-variables-with-select"><i class="fa fa-check"></i><b>8.5</b> Select variables with <code>select()</code></a></li>
<li class="chapter" data-level="8.6" data-path="data-transformation.html"><a href="data-transformation.html#group-data-with-group_by"><i class="fa fa-check"></i><b>8.6</b> Group data with <code>group_by()</code></a></li>
<li class="chapter" data-level="8.7" data-path="data-transformation.html"><a href="data-transformation.html#edit-and-add-new-variables-with-mutate"><i class="fa fa-check"></i><b>8.7</b> Edit and add new variables with <code>mutate()</code></a><ul>
<li class="chapter" data-level="8.7.1" data-path="data-transformation.html"><a href="data-transformation.html#cases-when-you-should-use-case_when"><i class="fa fa-check"></i><b>8.7.1</b> Cases when you should use <code>case_when()</code></a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="data-transformation.html"><a href="data-transformation.html#summarise-data-with-summarise"><i class="fa fa-check"></i><b>8.8</b> Summarise data with <code>summarise()</code></a></li>
<li class="chapter" data-level="8.9" data-path="data-transformation.html"><a href="data-transformation.html#joining-datasets-with-_join"><i class="fa fa-check"></i><b>8.9</b> Joining datasets with <code>*_join()</code></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="analysis.html"><a href="analysis.html"><i class="fa fa-check"></i><b>9</b> Analysis</a></li>
<li class="chapter" data-level="10" data-path="creating-functions.html"><a href="creating-functions.html"><i class="fa fa-check"></i><b>10</b> Creating functions</a><ul>
<li class="chapter" data-level="10.1" data-path="creating-functions.html"><a href="creating-functions.html#it-can-be-useful-to-make-your-own-function"><i class="fa fa-check"></i><b>10.1</b> It can be useful to make your own function</a></li>
<li class="chapter" data-level="10.2" data-path="creating-functions.html"><a href="creating-functions.html#defining-simple-functions"><i class="fa fa-check"></i><b>10.2</b> Defining simple functions</a></li>
<li class="chapter" data-level="10.3" data-path="creating-functions.html"><a href="creating-functions.html#more-complex-functions"><i class="fa fa-check"></i><b>10.3</b> More complex functions</a></li>
<li class="chapter" data-level="10.4" data-path="creating-functions.html"><a href="creating-functions.html#sets-of-functions"><i class="fa fa-check"></i><b>10.4</b> Sets of functions</a></li>
<li class="chapter" data-level="10.5" data-path="creating-functions.html"><a href="creating-functions.html#using-purrrmap"><i class="fa fa-check"></i><b>10.5</b> Using <code>purrr::map</code></a></li>
<li class="chapter" data-level="10.6" data-path="creating-functions.html"><a href="creating-functions.html#sharing-your-useful-functions-with-grattan"><i class="fa fa-check"></i><b>10.6</b> Sharing your useful functions with Grattan</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="version-control.html"><a href="version-control.html"><i class="fa fa-check"></i><b>11</b> Version control</a><ul>
<li class="chapter" data-level="11.1" data-path="version-control.html"><a href="version-control.html#version-control-is-important-and-intimidating"><i class="fa fa-check"></i><b>11.1</b> Version control is important and intimidating</a></li>
<li class="chapter" data-level="11.2" data-path="version-control.html"><a href="version-control.html#github"><i class="fa fa-check"></i><b>11.2</b> Github</a></li>
<li class="chapter" data-level="11.3" data-path="version-control.html"><a href="version-control.html#git"><i class="fa fa-check"></i><b>11.3</b> Git</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/grattan/R_at_Grattan" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using R at Grattan Institute</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chart-cookbook" class="section level1">
<h1><span class="header-section-number">5</span> Chart cookbook</h1>
<p>This section takes you through a few often-used chart types.</p>
<div id="set-up" class="section level2">
<h2><span class="header-section-number">5.1</span> Set up</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(grattantheme)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(ggrepel)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(absmapsdata)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">library</span>(scales)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">library</span>(ggfittext)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># note: to be added to grattantheme; remove this when done</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">grattan_label &lt;-<span class="st"> </span><span class="cf">function</span>(..., <span class="dt">size =</span> <span class="dv">18</span>) {</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  .size =<span class="st"> </span>size <span class="op">/</span><span class="st"> </span>ggplot2<span class="op">::</span>.pt</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  </a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw">geom_label_repel</span>(..., </a>
<a class="sourceLine" id="cb2-7" data-line-number="7">           <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>,</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">           <span class="dt">label.padding =</span> <span class="kw">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;lines&quot;</span>), </a>
<a class="sourceLine" id="cb2-9" data-line-number="9">           <span class="dt">label.size =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">           <span class="dt">size =</span> .size)</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">}</a></code></pre></div>
<p>The <code>sa3_income</code> dataset will be used for all key examples in this chapter.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> It is a long dataset from the ABS that contains the median income and number of workers by Statistical Area 3, occupation and sex between 2010 and 2015.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">sa3_income &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/sa3_income.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(median_income),</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">         <span class="op">!</span><span class="kw">is.na</span>(average_income))</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   sa3 = col_double(),
##   sa3_name = col_character(),
##   sa3_sqkm = col_double(),
##   sa4_name = col_character(),
##   gcc_name = col_character(),
##   state = col_character(),
##   occupation = col_character(),
##   occ_short = col_character(),
##   gender = col_character(),
##   year = col_double(),
##   median_income = col_double(),
##   average_income = col_double(),
##   workers = col_double()
## )</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">head</span>(sa3_income)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 13
##     sa3 sa3_name sa3_sqkm sa4_name gcc_name state occupation occ_short
##   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;    
## 1 10102 Queanbe…    6511. Capital… Rest of… NSW   Clerical … Admin    
## 2 10102 Queanbe…    6511. Capital… Rest of… NSW   Clerical … Admin    
## 3 10102 Queanbe…    6511. Capital… Rest of… NSW   Clerical … Admin    
## 4 10102 Queanbe…    6511. Capital… Rest of… NSW   Clerical … Admin    
## 5 10102 Queanbe…    6511. Capital… Rest of… NSW   Clerical … Admin    
## 6 10102 Queanbe…    6511. Capital… Rest of… NSW   Clerical … Admin    
## # … with 5 more variables: gender &lt;chr&gt;, year &lt;dbl&gt;, median_income &lt;dbl&gt;,
## #   average_income &lt;dbl&gt;, workers &lt;dbl&gt;</code></pre>
</div>
<div id="bar-charts" class="section level2">
<h2><span class="header-section-number">5.2</span> Bar charts</h2>
<p>Bar charts are made with <code>geom_bar</code> or <code>geom_col</code>. Creating a bar chart will look something like this:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>data<span class="op">&gt;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="op">&lt;</span>xvar<span class="op">&gt;</span>, <span class="dt">y =</span> <span class="op">&lt;</span>yvar<span class="op">&gt;</span>),</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">     <span class="dt">stat =</span> <span class="op">&lt;</span>STAT<span class="op">&gt;</span>, </a>
<a class="sourceLine" id="cb7-4" data-line-number="4">     <span class="dt">position =</span> <span class="op">&lt;</span>POSITION<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="st">  </span>)</a></code></pre></div>
<p>It has two key arguments: <code>stat</code> and <code>position</code>.</p>
<p>First, <code>stat</code> defines what kind of <em>operation</em> the function will do on the dataset before plotting. Some options are:</p>
<ul>
<li><code>&quot;count&quot;</code>, the <strong>default</strong>: count the number of observations in a particular group, and plot that number. This is useful when you’re using microdata. When this is the case, there is no need for a <code>y</code> aesthetic.</li>
<li><code>&quot;sum&quot;</code>: sum the values of the <code>y</code> aesthetic.</li>
<li><code>&quot;identity&quot;</code>: directly report the values of the <code>y</code> aesthetic. This is how PowerPoint and Excel charts work.</li>
</ul>
<p>You can use <strong><code>geom_col</code></strong> instead, as a shortcut for <code>geom_bar(stat = &quot;identity)</code>.</p>
<p>Second, <code>position</code>, dictates how multiple bars occupying the same x-axis position will positioned. The options are:</p>
<ul>
<li><code>&quot;stack&quot;</code>, the default: bars in the same group are stacked atop one another.</li>
<li><code>&quot;dodge&quot;</code>: bars in the same group are positioned next to one another.</li>
<li><code>&quot;fill&quot;</code>: bars in the same group are stacked and all fill to 100 per cent.</li>
</ul>
<p>First, we’ll take the <code>sa3_income</code> dataset and create a summary table of total workers and income by state, greater capital city area, professional work and gender. We’ll use this <code>base_data</code> throughout this section.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">base_data &lt;-<span class="st"> </span>sa3_income <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>gender <span class="op">==</span><span class="st"> &quot;Persons&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">income =</span> average_income <span class="op">*</span><span class="st"> </span>workers,</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">         <span class="dt">prof =</span> <span class="kw">if_else</span>(occupation <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Professionals&quot;</span>, <span class="st">&quot;Managers&quot;</span>),</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">                        <span class="st">&quot;Professional&quot;</span>,</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">                        <span class="st">&quot;Non-professional&quot;</span>),</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">         <span class="dt">prof =</span> <span class="kw">factor</span>(prof, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Professional&quot;</span>, <span class="st">&quot;Non-professional&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="st">  </span><span class="kw">group_by</span>(state, gcc_name, prof, gender) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">workers =</span> <span class="kw">sum</span>(workers),</a>
<a class="sourceLine" id="cb8-10" data-line-number="10">            <span class="dt">income =</span> <span class="kw">sum</span>(income),</a>
<a class="sourceLine" id="cb8-11" data-line-number="11">            <span class="dt">average_income =</span> income <span class="op">/</span><span class="st"> </span>workers)</a></code></pre></div>
<p>Time to create a bar chart!<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>
You’ll plot average incomes by state and gender, so first thing you’ll do is <strong>create the dataset that you want to plot</strong>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">data &lt;-<span class="st"> </span>base_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(state, gender) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">average_income =</span> <span class="kw">sum</span>(income) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(workers))</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"></a>
<a class="sourceLine" id="cb9-5" data-line-number="5">data</a></code></pre></div>
<pre><code>## # A tibble: 16 x 3
## # Groups:   state [8]
##    state gender average_income
##    &lt;chr&gt; &lt;chr&gt;           &lt;dbl&gt;
##  1 ACT   Men            71965.
##  2 ACT   Women          59952.
##  3 NSW   Men            64612.
##  4 NSW   Women          48603.
##  5 NT    Men            67125.
##  6 NT    Women          53003.
##  7 Qld   Men            61531.
##  8 Qld   Women          44518.
##  9 SA    Men            56444.
## 10 SA    Women          43519.
## 11 Tas   Men            52608.
## 12 Tas   Women          41353.
## 13 Vic   Men            60362.
## 14 Vic   Women          45236.
## 15 WA    Men            72822.
## 16 WA    Women          47251.</code></pre>
<p>Looks good: you have one observation (row) for each state <span class="math inline">\(\times\)</span> gender group you want to plot, and a value for their average income. Put <code>state</code> on the x-axis, <code>average_income</code> on the y-axis, and split gender by fill-colour (<code>fill</code>).<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>
And because you have the <em>actual</em> values you want to plot from your <code>data</code> object, tell <code>geom_bar</code> to ‘just use the number provided’ with <code>stat = &quot;identity&quot;</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> state,          <span class="co"># x-axis is state</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3">             <span class="dt">y =</span> average_income, <span class="co"># y-axis is income</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4">             <span class="dt">fill =</span> gender)) <span class="op">+</span><span class="st">      </span><span class="co"># fill colour is gender</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span><span class="st">  </span><span class="co"># &quot;just use the number that&#39;s there&quot;</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="st">  </span><span class="kw">theme_grattan</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="st">  </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> dollar) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="st">  </span><span class="kw">grattan_fill_manual</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="Visualisation_cookbook_files/figure-html/bar1a-1.png" width="839.04" /></p>
<p>Before addressing the accidental stacking, note that there is a short-cut-geom for <code>geom_bar(stat = &quot;identity&quot;)</code>: <code>geom_col</code>. Using that instead, without the need for the <code>stat</code> argument gives the same result:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> state,        </a>
<a class="sourceLine" id="cb12-3" data-line-number="3">             <span class="dt">y =</span> average_income,</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">             <span class="dt">fill =</span> gender)) <span class="op">+</span><span class="st">     </span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span><span class="st">                 </span><span class="co"># no need for stat = &quot;identity&quot;</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="st">  </span><span class="kw">theme_grattan</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="st">  </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> dollar) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="st">  </span><span class="kw">grattan_fill_manual</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb12-10" data-line-number="10">       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="Visualisation_cookbook_files/figure-html/bar_col-1.png" width="839.04" /></p>
<p>The <code>fill</code> aesthetic creates two series – one for women, one for men – and <code>geom_col</code> stacks them by default. You can change this behaviour with the <code>position</code> argument:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> state,         </a>
<a class="sourceLine" id="cb13-3" data-line-number="3">             <span class="dt">y =</span> average_income,</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">             <span class="dt">fill =</span> gender)) <span class="op">+</span><span class="st">    </span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># dodge instead of stack the series</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="st">  </span><span class="kw">theme_grattan</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="st">  </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> dollar) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="st">  </span><span class="kw">grattan_fill_manual</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb13-10" data-line-number="10">       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="Visualisation_cookbook_files/figure-html/bar1b-1.png" width="839.04" /></p>
<p>You can also <strong>order</strong> the groups in your chart by a variable. If you want to order states by population, use <code>reorder</code> inside <code>aes</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(state, <span class="op">-</span>average_income), <span class="co"># change the order of state</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3">             <span class="dt">y =</span> average_income,</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">             <span class="dt">fill =</span> gender)) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="st">  </span><span class="kw">theme_grattan</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="st">  </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> dollar) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="st">  </span><span class="kw">grattan_fill_manual</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb14-10" data-line-number="10">       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="Visualisation_cookbook_files/figure-html/bar2-1.png" width="839.04" /></p>
<p>To flip the chart – a useful move when you have long labels – add <code>coord_flipped</code> (ie ‘flip coordinates’) and tell <code>theme_grattan</code> that the plot is flipped using <code>flipped = TRUE</code>.</p>
<p>However, while the <em>coordinates</em> have been flipped, the underlying data hasn’t. If you want to refer to the <code>average_income</code> axis, which now lies horizontally, you would still refer to the <code>y</code> axis (eg <code>grattan_y_continuous</code> still refers to your <code>y</code> aesthetic, <code>average_income</code>).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(state, <span class="op">-</span>average_income),</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">             <span class="dt">y =</span> average_income,</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">             <span class="dt">fill =</span> gender)) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="st">  </span><span class="kw">theme_grattan</span>(<span class="dt">flipped =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st">   </span><span class="co"># tell theme_grattan of flipping</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="st">  </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> dollar) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="st">  </span><span class="kw">grattan_fill_manual</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="co"># flip the chart</span></a></code></pre></div>
<p><img src="Visualisation_cookbook_files/figure-html/bar4-1.png" width="839.04" /></p>
<div id="labelling-bar-charts" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Labelling bar charts</h3>
<p>Labelling charts in the Grattan style means labelling <em>one</em> of each series and letting the reader connect the dots.</p>
<p>First, create a base chart that we’ll use for the next few charts:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">bar &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(state, <span class="op">-</span>average_income),</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">             <span class="dt">y =</span> average_income,</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">             <span class="dt">fill =</span> gender)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="st">  </span><span class="kw">theme_grattan</span>(<span class="dt">flipped =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="st">  </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> dollar) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="st">  </span><span class="kw">grattan_fill_manual</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb16-10" data-line-number="10">       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="st">  </span><span class="kw">coord_flip</span>()</a>
<a class="sourceLine" id="cb16-12" data-line-number="12"></a>
<a class="sourceLine" id="cb16-13" data-line-number="13">bar</a></code></pre></div>
<p><img src="Visualisation_cookbook_files/figure-html/unnamed-chunk-2-1.png" width="839.04" /></p>
<p>You can use <code>grattan_label</code> to label your charts. This function is a ‘wrapper’ around <code>geom_label_repel</code> that has settings that we tend to like: white background with a thin margin, 18-point font, and no border. It takes the standard arguments of <code>geom_label_repel</code>.</p>
<p>Section <a href="data-visualisation.html#adding-labels">4.6</a> shows how labels are treated like data points: they need to know where to go (<code>x</code> and <code>y</code>) and what to show (<code>label</code>). But if you provide <em>every point</em> to your labelling <code>geom</code>, it will plot every label:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">bar <span class="op">+</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="st">  </span><span class="kw">grattan_label</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> gender,  <span class="co"># colour the text according to gender</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3">                    <span class="dt">label =</span> gender),  <span class="co"># label the text according to gender</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4">            <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="dv">1</span>),  <span class="co"># position dodge with width 1</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5">            <span class="dt">hjust =</span> <span class="fl">-0.1</span>) <span class="op">+</span><span class="st">  </span><span class="co"># horizontally align the label so its outside the bar</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="st">  </span><span class="kw">grattan_colour_manual</span>(<span class="dv">2</span>)   <span class="co"># define colour as two grattan colours</span></a></code></pre></div>
<p><img src="Visualisation_cookbook_files/figure-html/unnamed-chunk-3-1.png" width="839.04" /></p>
<p>To just label <em>one</em> of the plots – ie the first one, Tasmania in this case – we need to tell <code>grattan_label</code>. The easiest way to do this is by <strong>creating a label dataset beforehand</strong>, like <code>label_gender</code> below. This just includes the observations you want to label:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">label_gender &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(state <span class="op">==</span><span class="st"> &quot;Tas&quot;</span>)  <span class="co"># just want Tasmania observations</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"></a>
<a class="sourceLine" id="cb18-4" data-line-number="4">bar <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="st">  </span><span class="kw">grattan_label</span>(<span class="dt">data =</span> label_gender,  <span class="co"># supply the new dataset</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6">                <span class="kw">aes</span>(<span class="dt">colour =</span> gender,</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">                    <span class="dt">label =</span> gender), </a>
<a class="sourceLine" id="cb18-8" data-line-number="8">                <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb18-9" data-line-number="9">                <span class="dt">hjust =</span> <span class="fl">-0.1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="st">  </span><span class="kw">grattan_colour_manual</span>(<span class="dv">2</span>)</a></code></pre></div>
<p><img src="Visualisation_cookbook_files/figure-html/unnamed-chunk-4-1.png" width="839.04" /></p>
<p>Labelling a vertical bar chart is much the same, but you might find yourself with less horizontal space. After creating a new base chart, our previous technique is a bit off:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># Create vertical bar chart</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">vbar &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(state, <span class="op">-</span>average_income),</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">             <span class="dt">y =</span> average_income,</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">             <span class="dt">fill =</span> gender)) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="st">  </span><span class="kw">theme_grattan</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="st">  </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> dollar) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="st">  </span><span class="kw">grattan_fill_manual</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb19-11" data-line-number="11">       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb19-12" data-line-number="12"></a>
<a class="sourceLine" id="cb19-13" data-line-number="13"><span class="co"># Create label dataset</span></a>
<a class="sourceLine" id="cb19-14" data-line-number="14">label_gender &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-15" data-line-number="15"><span class="st">  </span><span class="kw">filter</span>(state <span class="op">==</span><span class="st"> &quot;ACT&quot;</span>)  <span class="co"># just want ACT observations</span></a>
<a class="sourceLine" id="cb19-16" data-line-number="16"></a>
<a class="sourceLine" id="cb19-17" data-line-number="17"><span class="co"># Label chart </span></a>
<a class="sourceLine" id="cb19-18" data-line-number="18">vbar <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-19" data-line-number="19"><span class="st">  </span><span class="kw">grattan_label</span>(<span class="dt">data =</span> label_gender,  <span class="co"># supply the new dataset</span></a>
<a class="sourceLine" id="cb19-20" data-line-number="20">              <span class="kw">aes</span>(<span class="dt">colour =</span> gender,</a>
<a class="sourceLine" id="cb19-21" data-line-number="21">                  <span class="dt">label =</span> gender), </a>
<a class="sourceLine" id="cb19-22" data-line-number="22">              <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb19-23" data-line-number="23">              <span class="dt">hjust =</span> <span class="fl">0.5</span>,  <span class="co"># centre horizontally</span></a>
<a class="sourceLine" id="cb19-24" data-line-number="24">              <span class="dt">vjust =</span> <span class="fl">-.1</span>) <span class="op">+</span><span class="st"> </span><span class="co"># nudged up a bit</span></a>
<a class="sourceLine" id="cb19-25" data-line-number="25"><span class="st">  </span><span class="kw">grattan_colour_manual</span>(<span class="dv">2</span>)</a></code></pre></div>
<p><img src="Visualisation_cookbook_files/figure-html/unnamed-chunk-5-1.png" width="839.04" /></p>
<p>It might be best to label the bars in empty space <em>above</em> the bars. First, expand the plot area by adding an <code>expand_top</code> argument to <code>grattan_y_continuous</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">vbar <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="st">  </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> dollar,</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">                       <span class="dt">expand_top =</span> <span class="fl">0.2</span>)</a></code></pre></div>
<p><img src="Visualisation_cookbook_files/figure-html/unnamed-chunk-6-1.png" width="839.04" /></p>
<p>That gives you a bit of breathing room. Use the same <code>label_gender</code> dataset to place labels above the first state (ACT). Like before, <code>grattan_label</code> is used to plot the labels – given a dataset and the right aesthetics – but you’ll need to tweak some of the settings to get it looking right.</p>
<p>By using <code>nudge_y = Inf</code>, you’re pushing the labels all the way to the top of the plot. Then, <code>direction = &quot;x&quot;</code> says ‘only move the labels horizontally to make sure they’re not overlapping’. Finally, <code>segment.colour = NA</code> turns off the line that connects the label to the data point (you can leave this out and see if you like the look of it!).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># Create label dataset</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">label_gender &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(state <span class="op">==</span><span class="st"> &quot;ACT&quot;</span>)  </a>
<a class="sourceLine" id="cb21-4" data-line-number="4"></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="co"># Plot with labels</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6">vbar <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="st">  </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> dollar,</a>
<a class="sourceLine" id="cb21-8" data-line-number="8">                     <span class="dt">expand_top =</span> <span class="fl">0.07</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-9" data-line-number="9"><span class="st">  </span><span class="kw">grattan_label</span>(<span class="dt">data =</span> label_gender,</a>
<a class="sourceLine" id="cb21-10" data-line-number="10">              <span class="kw">aes</span>(<span class="dt">colour =</span> gender,</a>
<a class="sourceLine" id="cb21-11" data-line-number="11">                  <span class="dt">label =</span> gender), </a>
<a class="sourceLine" id="cb21-12" data-line-number="12">              <span class="dt">nudge_y =</span> <span class="ot">Inf</span>, <span class="co"># move to the top of the plotting area</span></a>
<a class="sourceLine" id="cb21-13" data-line-number="13">              <span class="dt">direction =</span> <span class="st">&quot;x&quot;</span>, <span class="co"># automatically align along the x-axis</span></a>
<a class="sourceLine" id="cb21-14" data-line-number="14">              <span class="dt">segment.colour =</span> <span class="ot">NA</span>) <span class="op">+</span><span class="st">  </span><span class="co"># don&#39;t add a line to the data point</span></a>
<a class="sourceLine" id="cb21-15" data-line-number="15"><span class="st">  </span><span class="kw">grattan_colour_manual</span>(<span class="dv">2</span>)</a></code></pre></div>
<p><img src="Visualisation_cookbook_files/figure-html/unnamed-chunk-7-1.png" width="839.04" /></p>
<p>There is an alternative approach that can be used in situations that require only a couple of labels. The <code>annotate</code> function will add text to a plot in the place you tell it. It doesn’t require a new dataset, and is more like manually labelling a plot in Powerpoint.</p>
<p>The first argument of annotate is what kind of <em>thing</em> it is: <code>&quot;text&quot;</code>. Then set the label text you’d like, eg <code>&quot;label = Men&quot;</code>, and where it should go with <code>x</code> and <code>y</code>. Then set the <code>colour</code>, and fiddle with <code>hjust</code> (horizontal alignment) to get your desired placement.</p>
<p>The outcome is close to what we had with <code>grattan_label</code>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">vbar <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="st">  </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> dollar,</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">                       <span class="dt">expand_top =</span> <span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Men&quot;</span>,  <span class="co"># Male label</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5">           <span class="dt">x =</span> <span class="st">&quot;ACT&quot;</span>, <span class="dt">y =</span> <span class="fl">75e3</span>, </a>
<a class="sourceLine" id="cb22-6" data-line-number="6">           <span class="dt">colour =</span> grattan_orange,</a>
<a class="sourceLine" id="cb22-7" data-line-number="7">           <span class="dt">hjust =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Women&quot;</span>, <span class="co"># Female label</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9">           <span class="dt">x =</span> <span class="st">&quot;NT&quot;</span>, <span class="dt">y =</span> <span class="fl">75e3</span>, </a>
<a class="sourceLine" id="cb22-10" data-line-number="10">           <span class="dt">colour =</span> grattan_red,</a>
<a class="sourceLine" id="cb22-11" data-line-number="11">           <span class="dt">hjust =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="Visualisation_cookbook_files/figure-html/unnamed-chunk-8-1.png" width="839.04" /></p>
</div>
<div id="facet-bar" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Facetting bar charts</h3>
<p>‘Facetting’ a chart means you create a separate plot for each group. It’s particularly useful in showing differences between groups.</p>
<p>You can ‘facet’ bar charts – and any other chart type – with the <code>facet_grid</code> or <code>facet_wrap</code> commands. The <code>fadcet_wrap</code> tends to give you more control over label placement, so let’s start with that.</p>
<p>First, create a summary dataset of average income by professional employment, state and gender:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">data &lt;-<span class="st"> </span>base_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(prof, state, gender) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">average_income =</span> <span class="kw">sum</span>(income) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(workers))</a>
<a class="sourceLine" id="cb23-4" data-line-number="4"></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="kw">head</span>(data)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 4
## # Groups:   prof, state [3]
##   prof         state gender average_income
##   &lt;fct&gt;        &lt;chr&gt; &lt;chr&gt;           &lt;dbl&gt;
## 1 Professional ACT   Men            96488.
## 2 Professional ACT   Women          79828.
## 3 Professional NSW   Men            91624.
## 4 Professional NSW   Women          68445.
## 5 Professional NT    Men            87666.
## 6 Professional NT    Women          72940.</code></pre>
<p>Then plot a bar chart, similar to the one you made before, but add <code>facet_wrap</code> to the chain:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(state, average_income),         </a>
<a class="sourceLine" id="cb25-3" data-line-number="3">             <span class="dt">y =</span> average_income,</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">             <span class="dt">fill =</span> gender)) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>()) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="st">  </span><span class="kw">theme_grattan</span>(<span class="dt">flipped =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="st">  </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> dollar) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8"><span class="st">  </span><span class="kw">grattan_fill_manual</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb25-10" data-line-number="10">       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-11" data-line-number="11"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-12" data-line-number="12"><span class="st">  </span><span class="kw">facet_wrap</span>(prof <span class="op">~</span><span class="st"> </span>.) <span class="co"># facet &#39;prof&#39; around nothing else &#39;.&#39;</span></a></code></pre></div>
<p><img src="Visualisation_cookbook_files/figure-html/unnamed-chunk-10-1.png" width="839.04" /></p>
<p>Cool! Now you just have to tweak some settings to get the plot looking right on the page:</p>
<ul>
<li>Add a black line along <code>average_income = 0</code> to distinguish the plots.</li>
<li>Then define your ‘breaks’ (the spacing of the axis gridlines and labels) in <code>grattan_y_continuous</code>.</li>
<li>Add some additional space – <code>10mm</code> – between the two facet plots with <code>panel.spacing = unit(10, &quot;mm&quot;)</code> in the <code>theme</code> parameter.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></li>
<li>Left-align the facet titles with <code>strip.text = element_text(hjust = 0)</code><a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></li>
<li>We’re a bit tight for space along the bottom, so get rid of the “$” and replace with “comma”, then add that information in the <code>y</code> label.</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">facet_bar &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(state, average_income),         </a>
<a class="sourceLine" id="cb26-3" data-line-number="3">             <span class="dt">y =</span> average_income,</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">             <span class="dt">fill =</span> gender)) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb26-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>()) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="co"># add a black base line for each facet</span></a>
<a class="sourceLine" id="cb26-7" data-line-number="7"><span class="st">  </span><span class="kw">theme_grattan</span>(<span class="dt">flipped =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-8" data-line-number="8"><span class="st">  </span><span class="kw">grattan_y_continuous</span>(<span class="dt">labels =</span> comma, <span class="co"># change to comma</span></a>
<a class="sourceLine" id="cb26-9" data-line-number="9">                       <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">25e3</span>, <span class="fl">50e3</span>, <span class="fl">75e3</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># define your breaks</span></a>
<a class="sourceLine" id="cb26-10" data-line-number="10"><span class="st">  </span><span class="kw">grattan_fill_manual</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-11" data-line-number="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb26-12" data-line-number="12">       <span class="dt">y =</span> <span class="st">&quot;Annual income, $&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># add $ info in y-label</span></a>
<a class="sourceLine" id="cb26-13" data-line-number="13"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-14" data-line-number="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.spacing =</span> <span class="kw">unit</span>(<span class="dv">10</span>, <span class="st">&quot;mm&quot;</span>), <span class="co"># add some space between the plots</span></a>
<a class="sourceLine" id="cb26-15" data-line-number="15">        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># left-align facet titles</span></a>
<a class="sourceLine" id="cb26-16" data-line-number="16"><span class="st">  </span><span class="kw">facet_wrap</span>(prof <span class="op">~</span><span class="st"> </span>.)</a>
<a class="sourceLine" id="cb26-17" data-line-number="17"></a>
<a class="sourceLine" id="cb26-18" data-line-number="18">facet_bar</a></code></pre></div>
<p><img src="Visualisation_cookbook_files/figure-html/unnamed-chunk-11-1.png" width="839.04" /></p>
<p><strong>Finally</strong>, we’ll add the women/men labels – by creating a dataset with the labels we want and giving that to <code>grattan_label</code> –</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">label_data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(state <span class="op">==</span><span class="st"> &quot;ACT&quot;</span>,</a>
<a class="sourceLine" id="cb27-3" data-line-number="3">         prof <span class="op">==</span><span class="st"> &quot;Non-professional&quot;</span>)</a>
<a class="sourceLine" id="cb27-4" data-line-number="4"></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"></a>
<a class="sourceLine" id="cb27-7" data-line-number="7">facet_bar <span class="op">+</span></a>
<a class="sourceLine" id="cb27-8" data-line-number="8"><span class="st">  </span><span class="kw">grattan_label</span>(<span class="dt">data =</span> label_data,  <span class="co"># supply the new dataset</span></a>
<a class="sourceLine" id="cb27-9" data-line-number="9">                <span class="kw">aes</span>(<span class="dt">colour =</span> gender,</a>
<a class="sourceLine" id="cb27-10" data-line-number="10">                    <span class="dt">label =</span> gender), </a>
<a class="sourceLine" id="cb27-11" data-line-number="11">                <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb27-12" data-line-number="12">                <span class="dt">hjust =</span> <span class="fl">-.1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-13" data-line-number="13"><span class="st">  </span><span class="kw">grattan_colour_manual</span>(<span class="dv">2</span>) <span class="co"># define the colour scale</span></a></code></pre></div>
<p><img src="Visualisation_cookbook_files/figure-html/unnamed-chunk-12-1.png" width="839.04" /></p>
</div>
</div>
<div id="line-charts" class="section level2">
<h2><span class="header-section-number">5.3</span> Line charts</h2>
<p>A line chart has one key aesthetic: <code>group</code>. This tells <code>ggplot</code> how to connect individual lines.</p>
<p>First, we’ll take the <code>sa3_income</code> dataset and create a summary table of total workers and income by year, state, greater capital city area, professional work and gender. We’ll use this <code>base_data</code> throughout this section.</p>
<p>You can also add dots for each year by layering <code>geom_point</code> on top of <code>geom_line</code>:</p>
<p>If you wanted to show each state individually, you could <strong>facet</strong> your chart so that a separate plot was produced for each state:</p>
<p>To tidy this up, we can:</p>
<ol style="list-style-type: decimal">
<li>shorten the years to be “13”, “14”, etc instead of “2013”, “2014”, etc (via the <code>x</code> aesthetic)</li>
<li>shorten the y-axis labels to “millions” (via the <code>y</code> aesthetic)</li>
<li>add a black horizontal line at the bottom of each facet</li>
<li>give the facets a bit of room by adjusting <code>panel.spacing</code></li>
<li>define our own x-axis label breaks to just show <code>13</code>, <code>15</code> and <code>17</code></li>
</ol>
</div>
<div id="scatter-plots" class="section level2">
<h2><span class="header-section-number">5.4</span> Scatter plots</h2>
<p>Scatter plots require <code>x</code> and <code>y</code> aesthetics. These can then be coloured and faceted.</p>
<p>First, create a dataset that we’ll use for scatter plots. Take the <code>population_table</code> dataset and transform it to have one variable for population in 2013, and another for population in 2018:</p>
<p>Then plot it</p>
<p>It looks like the areas with the largest population grew the most between 2013 and 2018. To explore the relationship further, you can add a line-of-best-fit with <code>geom_smooth</code>:</p>
<p>You could colour-code positive and negative changes from within the <code>geom_point</code> aesthetic. Making a change there won’t pass through to the <code>geom_smooth</code> aesthetic, so your line-of-best-fit will apply to all data points.</p>
<p>Like the charts above, you could facet this by state to see if there were any interesting patterns. We’ll filter out ACT and NT because they only have one and two data points (SA4s) in them, respectively.</p>
</div>
<div id="distributions" class="section level2">
<h2><span class="header-section-number">5.5</span> Distributions</h2>
<p><code>geom_histogram</code>
<code>geom_density</code></p>
<p><code>ggridges::</code></p>
</div>
<div id="maps" class="section level2">
<h2><span class="header-section-number">5.6</span> Maps</h2>
<div id="sf-objects" class="section level3">
<h3><span class="header-section-number">5.6.1</span> <code>sf</code> objects</h3>
<p>[what is]</p>
</div>
<div id="using-absmapsdata" class="section level3">
<h3><span class="header-section-number">5.6.2</span> Using <code>absmapsdata</code></h3>
<p>The <code>absmapsdata</code> contains compressed, and tidied <code>sf</code> objects containing geometric information about ABS data structures. The included objects are:</p>
<ul>
<li>Statistical Area 1 2011 and 2016: <code>sa12011</code> or <code>sa12016</code></li>
<li>Statistical Area 2 2011 and 2016: <code>sa22011</code> or <code>sa22016</code></li>
<li>Statistical Area 3 2011 and 2016: <code>sa32011</code> or <code>sa32016</code></li>
<li>Statistical Area 4 2011 and 2016: <code>sa42011</code> or <code>sa42016</code></li>
<li>Greater Capital Cities 2011 and 2016: <code>gcc2011</code> or <code>gcc2016</code></li>
<li>Remoteness Areas 2011 and 2016: <code>ra2011</code> or <code>ra2016</code></li>
<li>State 2011 and 2016: <code>state2011</code> or <code>state2016</code></li>
<li>Commonwealth Electoral Divisions 2018: <code>ced2018</code></li>
<li>State Electoral Divisions 2018:<code>sed2018</code></li>
<li>Local Government Areas 2016 and 2018: <code>lga2016</code> or <code>lga2018</code></li>
<li>Postcodes 2016: <code>postcodes2016</code></li>
</ul>
<p>You can install the package from Github:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">remotes<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;wfmackey/absmapsdata&quot;</span>)</a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="kw">library</span>(absmapsdata)</a></code></pre></div>
<p>You will also need the <code>sf</code> package installed to handle the <code>sf</code> objects:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">&quot;sf&quot;</span>)</a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="kw">library</span>(sf)</a></code></pre></div>
</div>
<div id="making-choropleth-maps" class="section level3">
<h3><span class="header-section-number">5.6.3</span> Making choropleth maps</h3>
<p>Choropleth maps break an area into ‘bits’, and colours each ‘bit’ according to a variable.</p>
<p>SA4 is the largest non-state statistical area in the ABS ASGS standard.</p>
<p>You can join the <code>sf</code> objects from <code>absmapsdata</code> to your dataset using <code>left_join</code>. The variable names might be different – eg <code>sa4_name</code> compared to <code>sa4_name_2016</code> – so use the <code>by</code> function to match them.</p>
<p>You then plot a map like you would any other <code>ggplot</code>: provide your data, then choose your <code>aes</code> and your <code>geom</code>. For maps with <code>sf</code> objects, the <strong>key aesthetic</strong> is <code>geometry = geometry</code>, and the <strong>key geom</strong> is <code>geom_sf</code>.</p>
<p>The argument <code>lwd</code> controls the line width of area borders.</p>
<p>Note that RStudio takes a long time to render a map in the</p>
<p>Showing all of Australia on a single map is difficult: there are enormous areas that are home to few people which dominate the space. Showing individual states or capital city areas can sometimes be useful.</p>
<p>To do this, filter the <code>map_data</code> object:</p>
<div id="adding-labels-to-maps" class="section level4">
<h4><span class="header-section-number">5.6.3.1</span> Adding labels to maps</h4>
<p>You can add labels to choropleth maps with the standard <code>geom_text</code> or <code>geom_label</code>. Because it is likely that some labels will overlap, <code>ggrepel::geom_text_repel</code> or <code>ggrepel::geom_label_repel</code> is usually the better option.</p>
<p>To use <code>geom_(text|label)_repel</code>, you need to tell <code>ggrepel</code> where in</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">map &lt;-<span class="st"> </span>map_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="st">        </span><span class="kw">filter</span>(state <span class="op">==</span><span class="st"> &quot;Vic&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="st">        </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">geometry =</span> geometry)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="st">        </span><span class="kw">geom_sf</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> pop_change),</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">                <span class="dt">lwd =</span> <span class="fl">.1</span>,</a>
<a class="sourceLine" id="cb30-6" data-line-number="6">                <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-7" data-line-number="7"><span class="st">        </span><span class="kw">theme_void</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb30-8" data-line-number="8"><span class="st">        </span><span class="kw">grattan_fill_manual</span>(<span class="dt">discrete =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb30-9" data-line-number="9">                            <span class="dt">palette =</span> <span class="st">&quot;diverging&quot;</span>,</a>
<a class="sourceLine" id="cb30-10" data-line-number="10">                            <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>, <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb30-11" data-line-number="11">                            <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">10</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_label_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> sa4_name),</a>
<a class="sourceLine" id="cb30-13" data-line-number="13">                  <span class="dt">stat =</span> <span class="st">&quot;sf_coordinates&quot;</span>, <span class="dt">nudge_x =</span> <span class="dv">1000</span>, <span class="dt">segment.alpha =</span> <span class="fl">.5</span>,</a>
<a class="sourceLine" id="cb30-14" data-line-number="14">                  <span class="dt">size =</span> <span class="dv">4</span>, </a>
<a class="sourceLine" id="cb30-15" data-line-number="15">                  <span class="dt">direction =</span> <span class="st">&quot;y&quot;</span>,</a>
<a class="sourceLine" id="cb30-16" data-line-number="16">                  <span class="dt">label.size =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb30-17" data-line-number="17">                  <span class="dt">label.padding =</span> <span class="kw">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;lines&quot;</span>),</a>
<a class="sourceLine" id="cb30-18" data-line-number="18">                  <span class="dt">colour =</span> <span class="st">&quot;grey50&quot;</span>,</a>
<a class="sourceLine" id="cb30-19" data-line-number="19">                  <span class="dt">segment.color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-20" data-line-number="20"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">expand_scale</span>(<span class="dt">mult =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.2</span>))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-21" data-line-number="21"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-22" data-line-number="22"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;Population </span><span class="ch">\n</span><span class="st">change&quot;</span>)</a>
<a class="sourceLine" id="cb30-23" data-line-number="23"></a>
<a class="sourceLine" id="cb30-24" data-line-number="24">map</a></code></pre></div>
</div>
</div>
</div>
<div id="creating-simple-interactive-graphs-with-plotly" class="section level2">
<h2><span class="header-section-number">5.7</span> Creating simple interactive graphs with <code>plotly</code></h2>
<p><code>plotly::ggplotly()</code></p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>From <a href="https://www.abs.gov.au/AUSSTATS/abs@.nsf/DetailsPage/6524.0.55.0022011-2016?OpenDocument">ABS Employee income by occupation and sex, 2010-11 to 2015-16</a><a href="chart-cookbook.html#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Wooh! (Sorry, that’s an abuse of footnotes.)<a href="chart-cookbook.html#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>The aesthetic <code>fill</code> represents the ‘fill’ colour – the colour that fills the bars in your chart. The <code>colour</code> aesthetic controls the colours of the <em>lines</em>.<a href="chart-cookbook.html#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>The <code>unit</code> function takes two arguments: the number of the unit, then the unit itself (eg “mm” for millimetre, or “cm” for centremetre, etc.)<a href="chart-cookbook.html#fnref4" class="footnote-back">↩</a></p></li>
<li id="fn5"><p>The function <code>element_text</code> is useful for adjusting the look of text in a plot. With it, you can say you want the text to be red, <code>colour = &quot;red&quot;</code>, or MASSIVE, <code>size = 100</code>, or <strong>bold</strong>, <code>face = &quot;bold&quot;</code>.<a href="chart-cookbook.html#fnref5" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-visualisation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reading-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["r-at-grattan.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
